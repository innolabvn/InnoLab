2025-08-26 09:50:13,078 - innolab - INFO - ExecutionServiceNoMongo initialized with:
2025-08-26 09:50:13,078 - innolab - INFO -   Max iterations: 5
2025-08-26 09:50:13,079 - innolab - INFO -   Project key: my-service
2025-08-26 09:50:13,079 - innolab - INFO -   Source code path: d:\InnoLab\projects
2025-08-26 09:50:13,079 - innolab - INFO -   Scan directory: Flask_App
2025-08-26 09:50:13,079 - innolab - INFO -   Scan mode: ['bearer']
2025-08-26 09:50:13,079 - innolab - INFO -   Fix mode: ['llm']
2025-08-26 09:50:13,079 - innolab - INFO -   RAG available: True
2025-08-26 09:50:13,079 - innolab - INFO - Starting execution without RAG (mode: DifyMode.LOCAL)
2025-08-26 09:50:13,080 - innolab - INFO - 
=== ITERATION 1/5 ===
2025-08-26 09:50:13,080 - innolab - INFO - Starting Bearer scan for project: my-service
2025-08-26 09:50:13,081 - innolab - INFO - Removed existing Bearer results file: d:\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-26 09:50:13,081 - innolab - INFO - Scanning directory: d:\InnoLab\projects\Flask_App
2025-08-26 09:50:13,082 - innolab - ERROR - Command not found: bearer
2025-08-26 09:50:13,082 - innolab - INFO - Using Bearer Docker image
2025-08-26 09:50:13,082 - innolab - INFO - Running Bearer Docker scan: docker run --rm -v d:\InnoLab\projects\Flask_App:/scan -v d:\InnoLab\projects\SonarQ\bearer_results:/output bearer/bearer:latest scan /scan --format json --output /output/bearer_results_my-service.json --quiet
2025-08-26 09:50:14,041 - innolab - INFO - Analyzing codebase
2025-08-26 09:50:21,254 - innolab - ERROR - Command failed with return code 1
2025-08-26 09:50:21,254 - innolab - INFO - Bearer Docker scan completed successfully
2025-08-26 09:50:21,254 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-26 09:50:21,255 - innolab - INFO - Bearer scan results loaded successfully
2025-08-26 09:50:21,255 - innolab - INFO - Found 9 Bearer security issues
2025-08-26 09:50:21,255 - innolab - INFO - BEARER scanner found 9 bugs
2025-08-26 09:50:21,256 - innolab - INFO - Iteration 1: Found 9 open bugs (0 BUG, 0 CODE_SMELL) across scanners: BEARER
2025-08-26 09:50:21,256 - innolab - ERROR - Scan directory not found: D:\InnoLab\Flask_App
2025-08-26 09:50:21,256 - innolab - INFO - Need to fix 9 bugs using Dify
2025-08-26 09:50:21,256 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-26 09:50:21,256 - innolab - INFO - User: hieult
2025-08-26 09:50:21,256 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-26 09:50:21,257 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-26 09:50:21,257 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-26 09:50:21,257 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'src': '', 'report': '[{"key": "bearer_javascript_lang_dynamic_os_command_a15877223715018ff0b40de8ae5380b1_0", "rule": "javascript_lang_dynamic_os_command", "severity": "BLOCKER", "component": "test_vuln.js", "line": 20, "message": "Unsanitized dynamic input in OS command. ## Description\\n\\nIncorporating unsanitized dynamic input directly into operating system commands poses a significant security risk. This practice could give attackers the opportunity to execute harmful...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "security", "medium", "cwe-78"], "creationDate": "2025-08-26T09:50:21.255468", "updateDate": "2025-08-26T09:50:21.255474", "textRange": {"startLine": 20, "endLine": 20, "startOffset": 5, "endOffset": 7}}, {"key": "bearer_javascript_lang_hardcoded_secret_e9148cb3e49ff316df66e00484a16228_0", "rule": "javascript_lang_hardcoded_secret", "severity": "BLOCKER", "component": "test_vuln.js", "line": 6, "message": "Usage of hard-coded secret. ## Description\\n\\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\\n\\n## Remediations\\n\\n- **Do not**...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "security", "medium", "cwe-798"], "creationDate": "2025-08-26T09:50:21.255502", "updateDate": "2025-08-26T09:50:21.255503", "textRange": {"startLine": 6, "endLine": 6, "startOffset": 1, "endOffset": 39}}, {"key": "bearer_javascript_lang_hardcoded_secret_e9148cb3e49ff316df66e00484a16228_1", "rule": "javascript_lang_hardcoded_secret", "severity": "BLOCKER", "component": "test_vuln.js", "line": 7, "message": "Usage of hard-coded secret. ## Description\\n\\nStoring secrets directly in your code is a security risk. Instead, opt for environment variables or a secret management system to safeguard your secrets.\\n\\n## Remediations\\n\\n- **Do not**...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "security", "medium", "cwe-798"], "creationDate": "2025-08-26T09:50:21.255522", "updateDate": "2025-08-26T09:50:21.255523", "textRange": {"startLine": 7, "endLine": 7, "startOffset": 1, "endOffset": 32}}, {"key": "bearer_javascript_lang_os_command_injection_cc39913b65829db5799c3ad743e397e7_0", "rule": "javascript_lang_os_command_injection", "severity": "BLOCKER", "component": "test_vuln.js", "line": 20, "message": "Unsanitized user input in OS command. ## Description\\n\\nExecuting operating system commands with unsanitized user input can lead to command injection vulnerabilities. This occurs when attackers manipulate the input to execute unauthorized c...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "security", "medium", "cwe-78"], "creationDate": "2025-08-26T09:50:21.255542", "updateDate": "2025-08-26T09:50:21.255543", "textRange": {"startLine": 20, "endLine": 20, "startOffset": 5, "endOffset": 7}}, {"key": "bearer_javascript_express_cross_site_scripting_e665897cc7ecdef8d764bb2388077790_0", "rule": "javascript_express_cross_site_scripting", "severity": "CRITICAL", "component": "test_vuln.js", "line": 13, "message": "Unsanitized user input in HTTP response (XSS). ## Description\\n\\nIncluding unsanitized user input in HTTP responses exposes your application to cross-site scripting (XSS) attacks. This vulnerability allows attackers to inject malicious scripts into ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "security", "medium", "cwe-79"], "creationDate": "2025-08-26T09:50:21.255559", "updateDate": "2025-08-26T09:50:21.255561", "textRange": {"startLine": 13, "endLine": 13, "startOffset": 5, "endOffset": 20}}, {"key": "bearer_javascript_express_cross_site_scripting_e665897cc7ecdef8d764bb2388077790_1", "rule": "javascript_express_cross_site_scripting", "severity": "CRITICAL", "component": "test_vuln.js", "line": 28, "message": "Unsanitized user input in HTTP response (XSS). ## Description\\n\\nIncluding unsanitized user input in HTTP responses exposes your application to cross-site scripting (XSS) attacks. This vulnerability allows attackers to inject malicious scripts into ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "security", "medium", "cwe-79"], "creationDate": "2025-08-26T09:50:21.255573", "updateDate": "2025-08-26T09:50:21.255573", "textRange": {"startLine": 28, "endLine": 28, "startOffset": 5, "endOffset": 54}}, {"key": "bearer_javascript_lang_raw_html_using_user_input_9be1e223403fc9dcb11396f4579547d6_0", "rule": "javascript_lang_raw_html_using_user_input", "severity": "CRITICAL", "component": "test_vuln.js", "line": 28, "message": "Unsanitized user input in raw HTML strings (XSS). ## Description\\n\\nIncluding unsanitized user input in HTML exposes your application to cross-site scripting (XSS) attacks. This vulnerability allows attackers to inject malicious scripts into web pages ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "security", "medium", "cwe-79"], "creationDate": "2025-08-26T09:50:21.255587", "updateDate": "2025-08-26T09:50:21.255588", "textRange": {"startLine": 28, "endLine": 28, "startOffset": 14, "endOffset": 53}}, {"key": "bearer_javascript_express_helmet_missing_7fde4398d401d13a4909acdaa783f38f_0", "rule": "javascript_express_helmet_missing", "severity": "MAJOR", "component": "test_vuln.js", "line": 2, "message": "Missing Helmet configuration on HTTP headers. ## Description\\n\\nHelmet can help protect your app from some well-known web vulnerabilities by setting HTTP headers appropriately. Failing to configure Helmet for HTTP headers leaves your application vu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "security", "medium", "cwe-693"], "creationDate": "2025-08-26T09:50:21.255601", "updateDate": "2025-08-26T09:50:21.255602", "textRange": {"startLine": 2, "endLine": 2, "startOffset": 13, "endOffset": 22}}, {"key": "bearer_javascript_express_reduce_fingerprint_c72b79444d58bb2e38b078dcb8dcb120_0", "rule": "javascript_express_reduce_fingerprint", "severity": "MAJOR", "component": "test_vuln.js", "line": 2, "message": "Missing server configuration to reduce server fingerprinting. ## Description\\n\\nReducing server fingerprinting enhances security by making it harder for attackers to identify the software your server is running. Server fingerprinting involves analyzing the unique ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "security", "medium", "cwe-693"], "creationDate": "2025-08-26T09:50:21.255615", "updateDate": "2025-08-26T09:50:21.255616", "textRange": {"startLine": 2, "endLine": 2, "startOffset": 13, "endOffset": 22}}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-26 09:50:22,558 - innolab - INFO - Dify workflow run response status: 200
2025-08-26 09:50:22,558 - innolab - INFO - Dify workflow run response: {"task_id": "4fa59aec-3f10-4e58-bfd6-82aefc214a58", "workflow_run_id": "760b6bfb-be45-4908-a02b-d4e349c03818", "data": {"id": "760b6bfb-be45-4908-a02b-d4e349c03818", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "failed", "outputs": {}, "error": "[google] Error: req_id: 2844db5a8d PluginInvokeError: {\"args\":{},\"error_type\":\"ClientError\",\"message\":\"429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_content_free_tier_requests', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel-FreeTier', 'quotaDimensions': {'model': 'gemini-2.0-flash', 'location': 'global'}, 'quotaValue': '200'}]}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.RetryInfo', 'retryDelay': '37s'}]}}\"}", "elapsed_time": 1.234658, "total_tokens": 0, "total_steps": 3, "created_at": 1756176621, "finished_at": 1756176622}}
2025-08-26 09:50:22,560 - innolab - INFO - DIFY: list_bugs type: <class 'str'>, content: 
2025-08-26 09:50:22,560 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 0
2025-08-26 09:50:22,561 - innolab - ERROR - Failed to parse list_real_bugs as JSON: Expecting value: line 1 column 1 (char 0)
2025-08-26 09:50:22,562 - innolab - INFO - No real bugs to fix after analysis
2025-08-26 09:50:22,562 - innolab - INFO - === EXECUTION RESULT ===
2025-08-26 09:50:22,562 - innolab - INFO - Mode: LOCAL
2025-08-26 09:50:22,562 - innolab - INFO - Project: my-service
2025-08-26 09:50:22,563 - innolab - INFO - Total bugs fixed: 0
2025-08-26 09:50:22,563 - innolab - INFO - Total iterations: 1
2025-08-26 09:50:22,564 - innolab - INFO - Start time: 2025-08-26T09:50:13.079953
2025-08-26 09:50:22,564 - innolab - INFO - End time: 2025-08-26T09:50:22.562364
2025-08-26 09:50:22,564 - innolab - INFO - Iteration 1: 9 bugs found, 0 fixed
