2025-08-28 10:20:02,255 - innolab - INFO - ExecutionServiceNoMongo initialized with:
2025-08-28 10:20:02,256 - innolab - INFO -   Max iterations: 3
2025-08-28 10:20:02,256 - innolab - INFO -   Project key: my-service
2025-08-28 10:20:02,256 - innolab - INFO -   Source code path: c:\Users\HieuLT\Desktop\InnoLab\projects
2025-08-28 10:20:02,256 - innolab - INFO -   Scan directory: Flask_App
2025-08-28 10:20:02,256 - innolab - INFO -   Scan mode: ['bearer']
2025-08-28 10:20:02,256 - innolab - INFO -   Fix mode: ['llm']
2025-08-28 10:20:02,256 - innolab - INFO -   RAG available: True
2025-08-28 10:20:02,257 - innolab - INFO - Starting execution with RAG (mode: DifyMode.LOCAL)
2025-08-28 10:20:02,257 - innolab - INFO - 
=== ITERATION 1/3 ===
2025-08-28 10:20:02,257 - innolab - INFO - Starting Bearer scan for project: my-service
2025-08-28 10:20:02,258 - innolab - INFO - Removed existing Bearer results file: c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-28 10:20:02,258 - innolab - INFO - Scanning directory: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App
2025-08-28 10:20:02,259 - innolab - ERROR - Command not found: bearer
2025-08-28 10:20:02,259 - innolab - INFO - Using Bearer Docker image
2025-08-28 10:20:02,260 - innolab - INFO - Running Bearer Docker scan: docker run --rm -v c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App:/scan -v c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results:/output bearer/bearer:latest scan /scan --format json --output /output/bearer_results_my-service.json --quiet --skip-path node_modules,*.git,__pycache__,.venv,venv,dist,build
2025-08-28 10:20:03,639 - innolab - INFO - Analyzing codebase
2025-08-28 10:20:08,852 - innolab - ERROR - Command failed with return code 1
2025-08-28 10:20:08,853 - innolab - INFO - Bearer Docker scan completed successfully
2025-08-28 10:20:08,854 - innolab - INFO - Reading Bearer scan results from: c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-28 10:20:08,855 - innolab - INFO - Bearer scan results loaded successfully
2025-08-28 10:20:08,855 - innolab - INFO - Found 2 Bearer security issues
2025-08-28 10:20:08,855 - innolab - INFO - BEARER scanner found 2 bugs
2025-08-28 10:20:08,856 - innolab - INFO - Iteration 1: Found 2 open bugs (0 BUG, 0 CODE_SMELL) across scanners: BEARER
2025-08-28 10:20:08,856 - innolab - ERROR - Scan directory not found: C:\Users\HieuLT\Desktop\InnoLab\Flask_App
2025-08-28 10:20:08,857 - innolab - INFO - Need to fix 2 bugs using Dify
2025-08-28 10:20:08,857 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-28 10:20:08,857 - innolab - INFO - User: hieult
2025-08-28 10:20:08,858 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-28 10:20:08,858 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-28 10:20:08,858 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-28 10:20:08,858 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'True', 'src': '', 'report': '[{"key": "bearer_python_lang_avoid_pickle_97c590b3c24fe6d7133f6e4d3358ab50_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "app.py", "line": 139, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "security", "medium", "cwe-502"], "creationDate": "2025-08-28T10:20:08.855492", "updateDate": "2025-08-28T10:20:08.855501", "textRange": {"startLine": 139, "endLine": 139, "startOffset": 15, "endOffset": 33}}, {"key": "bearer_python_lang_ssl_verification_973982c3a3525d3706e7bd03aabb5970_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "app.py", "line": 149, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "security", "medium", "cwe-295"], "creationDate": "2025-08-28T10:20:08.855562", "updateDate": "2025-08-28T10:20:08.855565", "textRange": {"startLine": 149, "endLine": 149, "startOffset": 13, "endOffset": 55}}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-28 10:20:23,440 - innolab - INFO - Dify workflow run response status: 200
2025-08-28 10:20:23,441 - innolab - INFO - Dify workflow run response: {"task_id": "06040cce-33fa-4121-94c4-9ef792b2bbd6", "workflow_run_id": "903ed089-0041-43bf-b1fd-fd5b6ba18c7b", "data": {"id": "903ed089-0041-43bf-b1fd-fd5b6ba18c7b", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_97c590b3c24fe6d7133f6e4d3358ab50_0", "classification": "True Positive", "reason": "RAG context does not have enough information about pickle. The use of pickle library is inherently vulnerable.", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_973982c3a3525d3706e7bd03aabb5970_0", "classification": "True Positive", "reason": "RAG context does not have enough information about SSL verification. Missing SSL verification is a critical vulnerability.", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}], "bugs_to_fix": 2}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_97c590b3c24fe6d7133f6e4d3358ab50_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"RAG context does not have enough information about pickle. The use of pickle library is inherently vulnerable.\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_973982c3a3525d3706e7bd03aabb5970_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"RAG context does not have enough information about SSL verification. Missing SSL verification is a critical vulnerability.\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 2\n}"}, "error": "", "elapsed_time": 14.112792, "total_tokens": 28302, "total_steps": 6, "created_at": 1756351209, "finished_at": 1756351223}}
2025-08-28 10:20:23,441 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_97c590b3c24fe6d7133f6e4d3358ab50_0', 'classification': 'True Positive', 'reason': 'RAG context does not have enough information about pickle. The use of pickle library is inherently vulnerable.', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_973982c3a3525d3706e7bd03aabb5970_0', 'classification': 'True Positive', 'reason': 'RAG context does not have enough information about SSL verification. Missing SSL verification is a critical vulnerability.', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}], 'bugs_to_fix': 2}
2025-08-28 10:20:23,441 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 2
2025-08-28 10:20:23,441 - innolab - INFO - Starting fix_bugs for 2 bugs
2025-08-28 10:20:23,442 - innolab - INFO - DEBUG: scan_directory = Flask_App
2025-08-28 10:20:23,442 - innolab - INFO - DEBUG: innolab_root = c:\Users\HieuLT\Desktop\InnoLab\projects
2025-08-28 10:20:23,442 - innolab - INFO - DEBUG: source_dir = c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App
2025-08-28 10:20:23,442 - innolab - INFO - Fixing bugs in directory: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App
2025-08-28 10:20:23,443 - innolab - INFO - Created issues file: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App\list_real_bugs.json with 2 bugs
2025-08-28 10:20:23,443 - innolab - INFO - RAG integration enabled for bug fixing
2025-08-28 10:20:23,443 - innolab - INFO - Running command: python C:\Users\HieuLT\Desktop\InnoLab\SonarQ\batch_fix.py c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App --fix --auto --issues-file list_real_bugs.json --enable-rag
2025-08-28 10:20:59,112 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-28 10:20:59,113 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-28 10:20:59,113 - innolab - INFO - ======================================================================
2025-08-28 10:20:59,114 - innolab - INFO - FIXING Mode Enabled
2025-08-28 10:20:59,114 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-28 10:20:59,115 - innolab - INFO - RAG Integration: Enabled - Fixed bugs will be stored in RAG system
2025-08-28 10:20:59,116 - innolab - INFO - Issues file not found: list_real_bugs.json
2025-08-28 10:20:59,116 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250828_102027.log
2025-08-28 10:20:59,117 - innolab - INFO - Scan Results:
2025-08-28 10:20:59,117 - innolab - INFO - Directory: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App
2025-08-28 10:20:59,118 - innolab - INFO - Found 1 code files
2025-08-28 10:20:59,119 - innolab - INFO - Files to process:
2025-08-28 10:20:59,119 - innolab - INFO - 1. app.py
2025-08-28 10:20:59,119 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-28 10:20:59,120 - innolab - INFO - ======================================================================
2025-08-28 10:20:59,120 - innolab - INFO - Starting secure fixing...
2025-08-28 10:20:59,120 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250828_102027.log
2025-08-28 10:20:59,120 - innolab - INFO - [1/1] Fixing: app.py
2025-08-28 10:20:59,120 - innolab - INFO - Successfully added bug fix to RAG: app.py
2025-08-28 10:20:59,121 - innolab - INFO - Success (31.1s)
2025-08-28 10:20:59,121 - innolab - INFO - Changes: Size change: 1587 bytes; Similarity: 79.5%
2025-08-28 10:20:59,121 - innolab - INFO - ======================================================================
2025-08-28 10:20:59,121 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-28 10:20:59,121 - innolab - INFO - FIXED_FILES: 1
2025-08-28 10:20:59,121 - innolab - INFO - FAILED_FILES: 0
2025-08-28 10:20:59,121 - innolab - INFO - TOTAL_INPUT_TOKENS: 2266
2025-08-28 10:20:59,121 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 6370
2025-08-28 10:20:59,121 - innolab - INFO - TOTAL_TOKENS: 8636
2025-08-28 10:20:59,121 - innolab - INFO - AVERAGE_SIMILARITY: 0.795
2025-08-28 10:20:59,121 - innolab - INFO - THRESHOLD_MET_COUNT: 0
2025-08-28 10:20:59,121 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-28 10:20:59,121 - innolab - INFO - DETAILED_RESULTS:
2025-08-28 10:20:59,121 - innolab - INFO - FILE: app.py | STATUS: SUCCESS | SIMILARITY: 0.795 | INPUT_TOKENS: 2266 | OUTPUT_TOKENS: 6370 | TOTAL_TOKENS: 8636 | THRESHOLD_MET: False
2025-08-28 10:20:59,121 - innolab - INFO - AVERAGE_PROCESSING_TIME: 31.1
2025-08-28 10:20:59,121 - innolab - INFO - END_BATCH_RESULT
2025-08-28 10:20:59,121 - innolab - INFO - {"success": true, "fixed_count": 1, "failed_count": 0, "total_input_tokens": 2266, "total_output_tokens": 6370, "total_tokens": 8636, "average_similarity": 0.7948648404303409, "threshold_met_count": 0, "similarity_threshold": 0.85, "average_processing_time": 31.072053}
2025-08-28 10:21:01,327 - innolab - INFO - Batch fix completed successfully. Fixed 1 files
2025-08-28 10:21:01,328 - innolab - INFO - Token usage - Input: 2266, Output: 6370, Total: 8636
2025-08-28 10:21:01,328 - innolab - INFO - Average similarity: 0.795, Threshold met: 0
2025-08-28 10:21:01,328 - innolab - INFO - Cleaned up temporary issues file: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App\list_real_bugs.json
2025-08-28 10:21:01,329 - innolab - INFO - Starting Bearer scan for project: my-service
2025-08-28 10:21:01,330 - innolab - INFO - Removed existing Bearer results file: c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-28 10:21:01,330 - innolab - INFO - Scanning directory: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App
2025-08-28 10:21:01,333 - innolab - ERROR - Command not found: bearer
2025-08-28 10:21:01,333 - innolab - INFO - Using Bearer Docker image
2025-08-28 10:21:01,333 - innolab - INFO - Running Bearer Docker scan: docker run --rm -v c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App:/scan -v c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results:/output bearer/bearer:latest scan /scan --format json --output /output/bearer_results_my-service.json --quiet --skip-path node_modules,*.git,__pycache__,.venv,venv,dist,build
2025-08-28 10:21:02,300 - innolab - INFO - Analyzing codebase
2025-08-28 10:21:06,281 - innolab - INFO - Bearer Docker scan completed successfully
2025-08-28 10:21:06,282 - innolab - INFO - Reading Bearer scan results from: c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-28 10:21:06,282 - innolab - INFO - Bearer scan results loaded successfully
2025-08-28 10:21:06,283 - innolab - INFO - Found 0 Bearer security issues
2025-08-28 10:21:06,283 - innolab - INFO - Rescan found 0 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-28 10:21:06,283 - innolab - INFO - Bugs reduced: 2 (from 2 to 0)
2025-08-28 10:21:06,283 - innolab - INFO - Iteration 1 completed: all bugs resolved after rescan
2025-08-28 10:21:06,283 - innolab - INFO - === EXECUTION RESULT ===
2025-08-28 10:21:06,284 - innolab - INFO - Mode: LOCAL_with_rag
2025-08-28 10:21:06,284 - innolab - INFO - Project: my-service
2025-08-28 10:21:06,284 - innolab - INFO - Total bugs fixed: 1
2025-08-28 10:21:06,284 - innolab - INFO - Total iterations: 1
2025-08-28 10:21:06,284 - innolab - INFO - Start time: 2025-08-28T10:20:02.257147
2025-08-28 10:21:06,284 - innolab - INFO - End time: 2025-08-28T10:21:06.283942
2025-08-28 10:21:06,285 - innolab - INFO - Iteration 1: 2 bugs found, 1 fixed
