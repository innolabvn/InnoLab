2025-08-25 14:01:55,295 - innolab - INFO - ExecutionServiceNoMongo initialized with:
2025-08-25 14:01:55,295 - innolab - INFO -   Max iterations: 5
2025-08-25 14:01:55,295 - innolab - INFO -   Project key: my-service
2025-08-25 14:01:55,295 - innolab - INFO -   Source code path: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:01:55,295 - innolab - INFO -   Scan directory: source_bug
2025-08-25 14:01:55,296 - innolab - INFO -   Scan mode: bearer
2025-08-25 14:01:55,296 - innolab - INFO -   RAG available: True
2025-08-25 14:01:55,296 - innolab - INFO - Starting execution without RAG (mode: DifyMode.LOCAL)
2025-08-25 14:01:55,296 - innolab - INFO - 
=== ITERATION 1/5 ===
2025-08-25 14:01:55,297 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:01:55,297 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:01:55,298 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:01:55,298 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:01:55,298 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:01:55,298 - innolab - INFO - Iteration 1: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:01:55,298 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:01:55,298 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:01:55,299 - innolab - INFO - User: hieult
2025-08-25 14:01:55,299 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:01:55,299 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:01:55,299 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:01:55,299 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:01:55.298240", "updateDate": "2025-08-25T14:01:55.298244", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:01:55.298272", "updateDate": "2025-08-25T14:01:55.298273", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:01:55.298288", "updateDate": "2025-08-25T14:01:55.298289", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:02:01,468 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:02:01,469 - innolab - INFO - Dify workflow run response: {"task_id": "2a1eea96-efed-4cb2-892f-815ce457ef75", "workflow_run_id": "854b08f7-379c-4860-bf3f-d2e919c3df8b", "data": {"id": "854b08f7-379c-4860-bf3f-d2e919c3df8b", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. This is a security vulnerability.", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. This is a security vulnerability.", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. This is a security vulnerability.", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. This is a security vulnerability.\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. This is a security vulnerability.\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. This is a security vulnerability.\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 5.701908, "total_tokens": 3512, "total_steps": 4, "created_at": 1756105315, "finished_at": 1756105321}}
2025-08-25 14:02:01,470 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. This is a security vulnerability.', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. This is a security vulnerability.', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. This is a security vulnerability.', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:02:01,470 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:02:01,470 - innolab - INFO - Starting fix_bugs_llm for 2 bugs
2025-08-25 14:02:01,470 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:02:01,471 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:02:01,471 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:03:42,491 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:03:42,492 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:03:42,492 - innolab - INFO - ======================================================================
2025-08-25 14:03:42,493 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:03:42,493 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:03:42,494 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:03:42,494 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140203.log
2025-08-25 14:03:42,495 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:03:42,495 - innolab - INFO - Issues found in 0 files
2025-08-25 14:03:42,496 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140203.log
2025-08-25 14:03:42,496 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:03:42,497 - innolab - INFO - Scan Results:
2025-08-25 14:03:42,498 - innolab - INFO - Directory: source_bug
2025-08-25 14:03:42,498 - innolab - INFO - Found 11 code files
2025-08-25 14:03:42,498 - innolab - INFO - Files to process:
2025-08-25 14:03:42,499 - innolab - INFO - 1. appy.py
2025-08-25 14:03:42,499 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:03:42,500 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:03:42,501 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:03:42,501 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:03:42,501 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:03:42,502 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:03:42,503 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:03:42,503 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:03:42,504 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:03:42,505 - innolab - INFO - ... and 1 more files
2025-08-25 14:03:42,505 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:03:42,506 - innolab - INFO - ======================================================================
2025-08-25 14:03:42,507 - innolab - INFO - Starting secure fixing...
2025-08-25 14:03:42,507 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140203.log
2025-08-25 14:03:42,508 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:03:42,508 - innolab - INFO - Success (16.4s)
2025-08-25 14:03:42,509 - innolab - INFO - Changes: Size change: 429 bytes; Similarity: 51.3%
2025-08-25 14:03:42,509 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:03:42,510 - innolab - INFO - Success (2.8s)
2025-08-25 14:03:42,510 - innolab - INFO - Changes: Size change: 79 bytes; Similarity: 92.6%
2025-08-25 14:03:42,510 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:03:42,511 - innolab - INFO - Success (11.1s)
2025-08-25 14:03:42,512 - innolab - INFO - Changes: Size change: -320 bytes; Similarity: 42.4%
2025-08-25 14:03:42,512 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:03:42,513 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:03:42,514 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:03:42,514 - innolab - INFO - Failed: Syntax validation failed: Line 20: Missing semicolon
2025-08-25 14:03:42,515 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:03:42,516 - innolab - INFO - Success (5.6s)
2025-08-25 14:03:42,517 - innolab - INFO - Changes: Size change: -16 bytes; Similarity: 90.0%
2025-08-25 14:03:42,517 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:03:42,518 - innolab - INFO - Success (3.2s)
2025-08-25 14:03:42,519 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:03:42,520 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:03:42,520 - innolab - INFO - Success (7.6s)
2025-08-25 14:03:42,520 - innolab - INFO - Changes: Size change: 147 bytes; Similarity: 96.1%
2025-08-25 14:03:42,520 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:03:42,521 - innolab - INFO - Success (8.1s)
2025-08-25 14:03:42,522 - innolab - INFO - Changes: Size change: 284 bytes; Similarity: 82.9%
2025-08-25 14:03:42,523 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:03:42,523 - innolab - INFO - Success (5.7s)
2025-08-25 14:03:42,524 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:03:42,524 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:03:42,525 - innolab - INFO - Success (5.5s)
2025-08-25 14:03:42,525 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:03:42,526 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:03:42,527 - innolab - INFO - Retry 1: Safety issues found, retrying...
2025-08-25 14:03:42,527 - innolab - INFO - Retry 2: Safety issues found, retrying...
2025-08-25 14:03:42,527 - innolab - INFO - Success (9.8s)
2025-08-25 14:03:42,528 - innolab - INFO - Changes: Size change: 18 bytes; Similarity: 47.6%
2025-08-25 14:03:42,528 - innolab - INFO - ======================================================================
2025-08-25 14:03:42,528 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:03:42,528 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:03:42,529 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:03:42,529 - innolab - INFO - TOTAL_INPUT_TOKENS: 10103
2025-08-25 14:03:42,529 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 10641
2025-08-25 14:03:42,530 - innolab - INFO - TOTAL_TOKENS: 20744
2025-08-25 14:03:42,530 - innolab - INFO - AVERAGE_SIMILARITY: 0.803
2025-08-25 14:03:42,531 - innolab - INFO - THRESHOLD_MET_COUNT: 6
2025-08-25 14:03:42,531 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:03:42,532 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:03:42,532 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 0.513 | INPUT_TOKENS: 1437 | OUTPUT_TOKENS: 2704 | TOTAL_TOKENS: 4141 | THRESHOLD_MET: False
2025-08-25 14:03:42,532 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 0.926 | INPUT_TOKENS: 842 | OUTPUT_TOKENS: 365 | TOTAL_TOKENS: 1207 | THRESHOLD_MET: True
2025-08-25 14:03:42,533 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.424 | INPUT_TOKENS: 1284 | OUTPUT_TOKENS: 1790 | TOTAL_TOKENS: 3074 | THRESHOLD_MET: False
2025-08-25 14:03:42,534 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:03:42,534 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 0.900 | INPUT_TOKENS: 935 | OUTPUT_TOKENS: 840 | TOTAL_TOKENS: 1775 | THRESHOLD_MET: True
2025-08-25 14:03:42,534 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 417 | TOTAL_TOKENS: 1210 | THRESHOLD_MET: True
2025-08-25 14:03:42,535 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.961 | INPUT_TOKENS: 1193 | OUTPUT_TOKENS: 1174 | TOTAL_TOKENS: 2367 | THRESHOLD_MET: True
2025-08-25 14:03:42,536 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.829 | INPUT_TOKENS: 967 | OUTPUT_TOKENS: 1270 | TOTAL_TOKENS: 2237 | THRESHOLD_MET: False
2025-08-25 14:03:42,536 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 935 | OUTPUT_TOKENS: 936 | TOTAL_TOKENS: 1871 | THRESHOLD_MET: True
2025-08-25 14:03:42,537 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1010 | OUTPUT_TOKENS: 848 | TOTAL_TOKENS: 1858 | THRESHOLD_MET: True
2025-08-25 14:03:42,537 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 0.476 | INPUT_TOKENS: 707 | OUTPUT_TOKENS: 297 | TOTAL_TOKENS: 1004 | THRESHOLD_MET: False
2025-08-25 14:03:42,538 - innolab - INFO - AVERAGE_PROCESSING_TIME: 9.0
2025-08-25 14:03:42,539 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:03:44,780 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:03:44,781 - innolab - INFO - Token usage - Input: 10103, Output: 10641, Total: 20744
2025-08-25 14:03:44,782 - innolab - INFO - Average similarity: 0.803, Threshold met: 6
2025-08-25 14:03:44,784 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:03:44,784 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:03:44,785 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:03:44,786 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:03:44,786 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:03:44,787 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:03:44,787 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:03:44,787 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:03:44,788 - innolab - INFO - Iteration 1 completed: 3 bugs remain after rescan
2025-08-25 14:03:44,788 - innolab - INFO - 
=== ITERATION 2/5 ===
2025-08-25 14:03:44,789 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:03:44,789 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:03:44,790 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:03:44,791 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:03:44,791 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:03:44,792 - innolab - INFO - Iteration 2: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:03:44,792 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:03:44,793 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:03:44,793 - innolab - INFO - User: hieult
2025-08-25 14:03:44,793 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:03:44,793 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:03:44,794 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:03:44,794 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:03:44.791151", "updateDate": "2025-08-25T14:03:44.791164", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:03:44.791268", "updateDate": "2025-08-25T14:03:44.791275", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:03:44.791413", "updateDate": "2025-08-25T14:03:44.791419", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:03:51,155 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:03:51,156 - innolab - INFO - Dify workflow run response: {"task_id": "b56227a8-983f-44ca-8296-1dc68b30226f", "workflow_run_id": "2ba193fd-dab6-4514-9960-2f1b462e9de5", "data": {"id": "2ba193fd-dab6-4514-9960-2f1b462e9de5", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 6.129355, "total_tokens": 3626, "total_steps": 4, "created_at": 1756105424, "finished_at": 1756105431}}
2025-08-25 14:03:51,158 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:03:51,160 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:03:51,161 - innolab - INFO - Starting fix_bugs_llm for 2 bugs
2025-08-25 14:03:51,161 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:03:51,164 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:03:51,165 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:05:16,184 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:05:16,184 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:05:16,185 - innolab - INFO - ======================================================================
2025-08-25 14:05:16,186 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:05:16,186 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:05:16,187 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:05:16,187 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140352.log
2025-08-25 14:05:16,188 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:05:16,188 - innolab - INFO - Issues found in 0 files
2025-08-25 14:05:16,189 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140352.log
2025-08-25 14:05:16,190 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:05:16,190 - innolab - INFO - Scan Results:
2025-08-25 14:05:16,190 - innolab - INFO - Directory: source_bug
2025-08-25 14:05:16,191 - innolab - INFO - Found 11 code files
2025-08-25 14:05:16,191 - innolab - INFO - Files to process:
2025-08-25 14:05:16,191 - innolab - INFO - 1. appy.py
2025-08-25 14:05:16,192 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:05:16,192 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:05:16,192 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:05:16,193 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:05:16,194 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:05:16,194 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:05:16,195 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:05:16,195 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:05:16,196 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:05:16,196 - innolab - INFO - ... and 1 more files
2025-08-25 14:05:16,197 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:05:16,197 - innolab - INFO - ======================================================================
2025-08-25 14:05:16,198 - innolab - INFO - Starting secure fixing...
2025-08-25 14:05:16,199 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140352.log
2025-08-25 14:05:16,199 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:05:16,200 - innolab - INFO - Success (10.6s)
2025-08-25 14:05:16,201 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:05:16,201 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:05:16,202 - innolab - INFO - Success (6.6s)
2025-08-25 14:05:16,203 - innolab - INFO - Changes: Size change: -161 bytes; Similarity: 70.7%
2025-08-25 14:05:16,203 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:05:16,204 - innolab - INFO - Success (6.4s)
2025-08-25 14:05:16,205 - innolab - INFO - Changes: Size change: -277 bytes; Similarity: 62.6%
2025-08-25 14:05:16,206 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:05:16,207 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:05:16,208 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:05:16,208 - innolab - INFO - Failed: Syntax validation failed: Line 20: Missing semicolon; Line 83: Missing semicolon; Line 85: Missing semicolon
2025-08-25 14:05:16,209 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:05:16,210 - innolab - INFO - Success (5.0s)
2025-08-25 14:05:16,211 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:05:16,212 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:05:16,212 - innolab - INFO - Success (3.3s)
2025-08-25 14:05:16,213 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:05:16,214 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:05:16,215 - innolab - INFO - Success (8.1s)
2025-08-25 14:05:16,216 - innolab - INFO - Changes: Size change: -203 bytes; Similarity: 89.0%
2025-08-25 14:05:16,216 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:05:16,217 - innolab - INFO - Success (7.6s)
2025-08-25 14:05:16,218 - innolab - INFO - Changes: Size change: 1 bytes; Similarity: 100.0%
2025-08-25 14:05:16,219 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:05:16,219 - innolab - INFO - Success (7.0s)
2025-08-25 14:05:16,220 - innolab - INFO - Changes: Size change: 98 bytes; Similarity: 95.1%
2025-08-25 14:05:16,221 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:05:16,221 - innolab - INFO - Success (3.9s)
2025-08-25 14:05:16,222 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:05:16,223 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:05:16,224 - innolab - INFO - Success (2.9s)
2025-08-25 14:05:16,225 - innolab - INFO - Changes: Size change: 93 bytes; Similarity: 39.2%
2025-08-25 14:05:16,226 - innolab - INFO - ======================================================================
2025-08-25 14:05:16,227 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:05:16,228 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:05:16,228 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:05:16,229 - innolab - INFO - TOTAL_INPUT_TOKENS: 10251
2025-08-25 14:05:16,230 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 8902
2025-08-25 14:05:16,231 - innolab - INFO - TOTAL_TOKENS: 19153
2025-08-25 14:05:16,232 - innolab - INFO - AVERAGE_SIMILARITY: 0.857
2025-08-25 14:05:16,233 - innolab - INFO - THRESHOLD_MET_COUNT: 7
2025-08-25 14:05:16,234 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:05:16,234 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:05:16,235 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1451 | OUTPUT_TOKENS: 1601 | TOTAL_TOKENS: 3052 | THRESHOLD_MET: True
2025-08-25 14:05:16,236 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 0.707 | INPUT_TOKENS: 856 | OUTPUT_TOKENS: 905 | TOTAL_TOKENS: 1761 | THRESHOLD_MET: False
2025-08-25 14:05:16,237 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.626 | INPUT_TOKENS: 1301 | OUTPUT_TOKENS: 997 | TOTAL_TOKENS: 2298 | THRESHOLD_MET: False
2025-08-25 14:05:16,237 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:05:16,238 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 931 | OUTPUT_TOKENS: 745 | TOTAL_TOKENS: 1676 | THRESHOLD_MET: True
2025-08-25 14:05:16,239 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 404 | TOTAL_TOKENS: 1197 | THRESHOLD_MET: True
2025-08-25 14:05:16,240 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.890 | INPUT_TOKENS: 1232 | OUTPUT_TOKENS: 1255 | TOTAL_TOKENS: 2487 | THRESHOLD_MET: True
2025-08-25 14:05:16,241 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1031 | OUTPUT_TOKENS: 1044 | TOTAL_TOKENS: 2075 | THRESHOLD_MET: True
2025-08-25 14:05:16,242 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 0.951 | INPUT_TOKENS: 935 | OUTPUT_TOKENS: 1071 | TOTAL_TOKENS: 2006 | THRESHOLD_MET: True
2025-08-25 14:05:16,242 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1010 | OUTPUT_TOKENS: 549 | TOTAL_TOKENS: 1559 | THRESHOLD_MET: True
2025-08-25 14:05:16,244 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 0.392 | INPUT_TOKENS: 711 | OUTPUT_TOKENS: 331 | TOTAL_TOKENS: 1042 | THRESHOLD_MET: False
2025-08-25 14:05:16,245 - innolab - INFO - AVERAGE_PROCESSING_TIME: 7.6
2025-08-25 14:05:16,246 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:05:18,424 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:05:18,425 - innolab - INFO - Token usage - Input: 10251, Output: 8902, Total: 19153
2025-08-25 14:05:18,425 - innolab - INFO - Average similarity: 0.857, Threshold met: 7
2025-08-25 14:05:18,426 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:05:18,427 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:05:18,428 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:05:18,430 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:05:18,431 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:05:18,432 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:05:18,432 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:05:18,433 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:05:18,433 - innolab - INFO - Iteration 2 completed: 3 bugs remain after rescan
2025-08-25 14:05:18,434 - innolab - INFO - 
=== ITERATION 3/5 ===
2025-08-25 14:05:18,435 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:05:18,436 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:05:18,438 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:05:18,438 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:05:18,439 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:05:18,439 - innolab - INFO - Iteration 3: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:05:18,440 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:05:18,440 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:05:18,441 - innolab - INFO - User: hieult
2025-08-25 14:05:18,441 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:05:18,442 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:05:18,443 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:05:18,443 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:05:18.438801", "updateDate": "2025-08-25T14:05:18.438816", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:05:18.438888", "updateDate": "2025-08-25T14:05:18.438891", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:05:18.438939", "updateDate": "2025-08-25T14:05:18.438942", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:05:23,428 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:05:23,429 - innolab - INFO - Dify workflow run response: {"task_id": "d04e893b-7497-44c8-9382-75af23e27aaa", "workflow_run_id": "f8272392-bcec-430e-8f8d-09c59518bc9c", "data": {"id": "f8272392-bcec-430e-8f8d-09c59518bc9c", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3.0}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3.0\n}"}, "error": "", "elapsed_time": 4.752448, "total_tokens": 3535, "total_steps": 4, "created_at": 1756105518, "finished_at": 1756105523}}
2025-08-25 14:05:23,430 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3.0}
2025-08-25 14:05:23,431 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:05:23,432 - innolab - INFO - Starting fix_bugs_llm for 2 bugs
2025-08-25 14:05:23,432 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:05:23,434 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:05:23,434 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:06:52,298 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:06:52,298 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:06:52,299 - innolab - INFO - ======================================================================
2025-08-25 14:06:52,299 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:06:52,300 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:06:52,300 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:06:52,301 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140524.log
2025-08-25 14:06:52,301 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:06:52,302 - innolab - INFO - Issues found in 0 files
2025-08-25 14:06:52,302 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140524.log
2025-08-25 14:06:52,303 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:06:52,303 - innolab - INFO - Scan Results:
2025-08-25 14:06:52,303 - innolab - INFO - Directory: source_bug
2025-08-25 14:06:52,304 - innolab - INFO - Found 11 code files
2025-08-25 14:06:52,304 - innolab - INFO - Files to process:
2025-08-25 14:06:52,304 - innolab - INFO - 1. appy.py
2025-08-25 14:06:52,305 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:06:52,305 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:06:52,306 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:06:52,306 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:06:52,307 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:06:52,307 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:06:52,308 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:06:52,308 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:06:52,308 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:06:52,309 - innolab - INFO - ... and 1 more files
2025-08-25 14:06:52,309 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:06:52,310 - innolab - INFO - ======================================================================
2025-08-25 14:06:52,311 - innolab - INFO - Starting secure fixing...
2025-08-25 14:06:52,311 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140524.log
2025-08-25 14:06:52,312 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:06:52,312 - innolab - INFO - Success (8.8s)
2025-08-25 14:06:52,313 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,314 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:06:52,314 - innolab - INFO - Success (3.7s)
2025-08-25 14:06:52,315 - innolab - INFO - Changes: Size change: 54 bytes; Similarity: 94.3%
2025-08-25 14:06:52,315 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:06:52,315 - innolab - INFO - Success (6.2s)
2025-08-25 14:06:52,316 - innolab - INFO - Changes: Size change: 21 bytes; Similarity: 99.2%
2025-08-25 14:06:52,317 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:06:52,318 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:06:52,318 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:06:52,318 - innolab - INFO - Failed: Syntax validation failed: Line 7: Missing semicolon; Line 22: Missing semicolon
2025-08-25 14:06:52,319 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:06:52,320 - innolab - INFO - Success (5.1s)
2025-08-25 14:06:52,320 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,321 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:06:52,321 - innolab - INFO - Success (3.0s)
2025-08-25 14:06:52,322 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,322 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:06:52,323 - innolab - INFO - Retry 1: Safety issues found, retrying...
2025-08-25 14:06:52,324 - innolab - INFO - Success (17.0s)
2025-08-25 14:06:52,325 - innolab - INFO - Changes: Size change: 128 bytes; Similarity: 93.0%
2025-08-25 14:06:52,325 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:06:52,326 - innolab - INFO - Success (5.6s)
2025-08-25 14:06:52,326 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,327 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:06:52,327 - innolab - INFO - Success (12.2s)
2025-08-25 14:06:52,328 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,328 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:06:52,329 - innolab - INFO - Success (4.6s)
2025-08-25 14:06:52,329 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,330 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:06:52,331 - innolab - INFO - Success (2.0s)
2025-08-25 14:06:52,331 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:06:52,332 - innolab - INFO - ======================================================================
2025-08-25 14:06:52,332 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:06:52,333 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:06:52,334 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:06:52,334 - innolab - INFO - TOTAL_INPUT_TOKENS: 10103
2025-08-25 14:06:52,335 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 8938
2025-08-25 14:06:52,335 - innolab - INFO - TOTAL_TOKENS: 19041
2025-08-25 14:06:52,336 - innolab - INFO - AVERAGE_SIMILARITY: 0.987
2025-08-25 14:06:52,337 - innolab - INFO - THRESHOLD_MET_COUNT: 10
2025-08-25 14:06:52,338 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:06:52,338 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:06:52,339 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1451 | OUTPUT_TOKENS: 1384 | TOTAL_TOKENS: 2835 | THRESHOLD_MET: True
2025-08-25 14:06:52,340 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 0.943 | INPUT_TOKENS: 809 | OUTPUT_TOKENS: 523 | TOTAL_TOKENS: 1332 | THRESHOLD_MET: True
2025-08-25 14:06:52,340 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.992 | INPUT_TOKENS: 1227 | OUTPUT_TOKENS: 973 | TOTAL_TOKENS: 2200 | THRESHOLD_MET: True
2025-08-25 14:06:52,341 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:06:52,342 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 931 | OUTPUT_TOKENS: 670 | TOTAL_TOKENS: 1601 | THRESHOLD_MET: True
2025-08-25 14:06:52,343 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 434 | TOTAL_TOKENS: 1227 | THRESHOLD_MET: True
2025-08-25 14:06:52,344 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.930 | INPUT_TOKENS: 1173 | OUTPUT_TOKENS: 1036 | TOTAL_TOKENS: 2209 | THRESHOLD_MET: True
2025-08-25 14:06:52,345 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1031 | OUTPUT_TOKENS: 868 | TOTAL_TOKENS: 1899 | THRESHOLD_MET: True
2025-08-25 14:06:52,345 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 2193 | TOTAL_TOKENS: 3146 | THRESHOLD_MET: True
2025-08-25 14:06:52,346 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1010 | OUTPUT_TOKENS: 674 | TOTAL_TOKENS: 1684 | THRESHOLD_MET: True
2025-08-25 14:06:52,347 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 183 | TOTAL_TOKENS: 908 | THRESHOLD_MET: True
2025-08-25 14:06:52,347 - innolab - INFO - AVERAGE_PROCESSING_TIME: 7.9
2025-08-25 14:06:52,348 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:06:54,513 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:06:54,514 - innolab - INFO - Token usage - Input: 10103, Output: 8938, Total: 19041
2025-08-25 14:06:54,514 - innolab - INFO - Average similarity: 0.987, Threshold met: 10
2025-08-25 14:06:54,515 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:06:54,516 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:06:54,517 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:06:54,518 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:06:54,518 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:06:54,518 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:06:54,519 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:06:54,519 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:06:54,520 - innolab - INFO - Iteration 3 completed: 3 bugs remain after rescan
2025-08-25 14:06:54,520 - innolab - INFO - 
=== ITERATION 4/5 ===
2025-08-25 14:06:54,521 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:06:54,521 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:06:54,522 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:06:54,523 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:06:54,523 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:06:54,524 - innolab - INFO - Iteration 4: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:06:54,525 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:06:54,525 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:06:54,527 - innolab - INFO - User: hieult
2025-08-25 14:06:54,527 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:06:54,528 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:06:54,529 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:06:54,529 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:06:54.523093", "updateDate": "2025-08-25T14:06:54.523105", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:06:54.523175", "updateDate": "2025-08-25T14:06:54.523178", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:06:54.523223", "updateDate": "2025-08-25T14:06:54.523225", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:06:59,696 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:06:59,696 - innolab - INFO - Dify workflow run response: {"task_id": "7d376260-0022-411c-bb93-f2384f83a8f8", "workflow_run_id": "2d04b6e4-93d6-4034-be93-c0ad29e8890b", "data": {"id": "2d04b6e4-93d6-4034-be93-c0ad29e8890b", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 5.077851, "total_tokens": 3533, "total_steps": 4, "created_at": 1756105614, "finished_at": 1756105619}}
2025-08-25 14:06:59,697 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:06:59,697 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:06:59,697 - innolab - INFO - Starting fix_bugs_llm for 2 bugs
2025-08-25 14:06:59,698 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:06:59,698 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:06:59,698 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:08:21,919 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:08:21,920 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:08:21,921 - innolab - INFO - ======================================================================
2025-08-25 14:08:21,921 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:08:21,922 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:08:21,925 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:08:21,926 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140700.log
2025-08-25 14:08:21,926 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:08:21,927 - innolab - INFO - Issues found in 0 files
2025-08-25 14:08:21,927 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140700.log
2025-08-25 14:08:21,928 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:08:21,928 - innolab - INFO - Scan Results:
2025-08-25 14:08:21,929 - innolab - INFO - Directory: source_bug
2025-08-25 14:08:21,929 - innolab - INFO - Found 11 code files
2025-08-25 14:08:21,930 - innolab - INFO - Files to process:
2025-08-25 14:08:21,931 - innolab - INFO - 1. appy.py
2025-08-25 14:08:21,931 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:08:21,932 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:08:21,932 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:08:21,933 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:08:21,934 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:08:21,934 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:08:21,935 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:08:21,936 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:08:21,936 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:08:21,937 - innolab - INFO - ... and 1 more files
2025-08-25 14:08:21,938 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:08:21,939 - innolab - INFO - ======================================================================
2025-08-25 14:08:21,940 - innolab - INFO - Starting secure fixing...
2025-08-25 14:08:21,941 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140700.log
2025-08-25 14:08:21,942 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:08:21,942 - innolab - INFO - Success (9.2s)
2025-08-25 14:08:21,943 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:08:21,944 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:08:21,944 - innolab - INFO - Success (5.0s)
2025-08-25 14:08:21,945 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:08:21,946 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:08:21,947 - innolab - INFO - Success (7.1s)
2025-08-25 14:08:21,948 - innolab - INFO - Changes: Size change: -1 bytes; Similarity: 100.0%
2025-08-25 14:08:21,949 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:08:21,950 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:08:21,951 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:08:21,951 - innolab - INFO - Failed: Syntax validation failed: Line 20: Missing semicolon
2025-08-25 14:08:21,952 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:08:21,953 - innolab - INFO - Success (4.7s)
2025-08-25 14:08:21,953 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:08:21,953 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:08:21,953 - innolab - INFO - Success (3.0s)
2025-08-25 14:08:21,954 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:08:21,954 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:08:21,954 - innolab - INFO - Success (7.8s)
2025-08-25 14:08:21,954 - innolab - INFO - Changes: Size change: 81 bytes; Similarity: 97.8%
2025-08-25 14:08:21,954 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:08:21,955 - innolab - INFO - Success (7.5s)
2025-08-25 14:08:21,955 - innolab - INFO - Changes: Size change: 66 bytes; Similarity: 94.4%
2025-08-25 14:08:21,955 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:08:21,955 - innolab - INFO - Success (8.7s)
2025-08-25 14:08:21,955 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:08:21,955 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:08:21,956 - innolab - INFO - Success (5.8s)
2025-08-25 14:08:21,956 - innolab - INFO - Changes: Size change: 59 bytes; Similarity: 97.4%
2025-08-25 14:08:21,956 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:08:21,956 - innolab - INFO - Success (2.4s)
2025-08-25 14:08:21,956 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:08:21,957 - innolab - INFO - ======================================================================
2025-08-25 14:08:21,957 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:08:21,957 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:08:21,957 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:08:21,957 - innolab - INFO - TOTAL_INPUT_TOKENS: 10156
2025-08-25 14:08:21,957 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 9029
2025-08-25 14:08:21,958 - innolab - INFO - TOTAL_TOKENS: 19185
2025-08-25 14:08:21,958 - innolab - INFO - AVERAGE_SIMILARITY: 0.990
2025-08-25 14:08:21,958 - innolab - INFO - THRESHOLD_MET_COUNT: 10
2025-08-25 14:08:21,958 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:08:21,958 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:08:21,958 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1451 | OUTPUT_TOKENS: 1447 | TOTAL_TOKENS: 2898 | THRESHOLD_MET: True
2025-08-25 14:08:21,958 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 818 | OUTPUT_TOKENS: 591 | TOTAL_TOKENS: 1409 | THRESHOLD_MET: True
2025-08-25 14:08:21,958 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1238 | OUTPUT_TOKENS: 1099 | TOTAL_TOKENS: 2337 | THRESHOLD_MET: True
2025-08-25 14:08:21,958 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:08:21,958 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 931 | OUTPUT_TOKENS: 703 | TOTAL_TOKENS: 1634 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 413 | TOTAL_TOKENS: 1206 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.978 | INPUT_TOKENS: 1206 | OUTPUT_TOKENS: 1211 | TOTAL_TOKENS: 2417 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.944 | INPUT_TOKENS: 1031 | OUTPUT_TOKENS: 1130 | TOTAL_TOKENS: 2161 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 1344 | TOTAL_TOKENS: 2297 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 0.974 | INPUT_TOKENS: 1010 | OUTPUT_TOKENS: 844 | TOTAL_TOKENS: 1854 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 247 | TOTAL_TOKENS: 972 | THRESHOLD_MET: True
2025-08-25 14:08:21,959 - innolab - INFO - AVERAGE_PROCESSING_TIME: 7.4
2025-08-25 14:08:21,960 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:08:24,121 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:08:24,122 - innolab - INFO - Token usage - Input: 10156, Output: 9029, Total: 19185
2025-08-25 14:08:24,123 - innolab - INFO - Average similarity: 0.990, Threshold met: 10
2025-08-25 14:08:24,124 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:08:24,125 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:08:24,126 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:08:24,127 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:08:24,128 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:08:24,129 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:08:24,129 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:08:24,130 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:08:24,131 - innolab - INFO - Iteration 4 completed: 3 bugs remain after rescan
2025-08-25 14:08:24,131 - innolab - INFO - 
=== ITERATION 5/5 ===
2025-08-25 14:08:24,132 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:08:24,133 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:08:24,134 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:08:24,135 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:08:24,136 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:08:24,137 - innolab - INFO - Iteration 5: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:08:24,138 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:08:24,139 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:08:24,139 - innolab - INFO - User: hieult
2025-08-25 14:08:24,140 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:08:24,141 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:08:24,142 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:08:24,143 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:08:24.135190", "updateDate": "2025-08-25T14:08:24.135205", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:08:24.135350", "updateDate": "2025-08-25T14:08:24.135353", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:08:24.135411", "updateDate": "2025-08-25T14:08:24.135414", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:08:29,695 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:08:29,696 - innolab - INFO - Dify workflow run response: {"task_id": "68cba3cb-b9b9-4c8a-8415-251ed2ccc520", "workflow_run_id": "f6b8211e-ff0b-42f8-a39d-614fe53b707a", "data": {"id": "f6b8211e-ff0b-42f8-a39d-614fe53b707a", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 5.396331, "total_tokens": 3533, "total_steps": 4, "created_at": 1756105704, "finished_at": 1756105709}}
2025-08-25 14:08:29,697 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:08:29,698 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:08:29,698 - innolab - INFO - Starting fix_bugs_llm for 2 bugs
2025-08-25 14:08:29,698 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:08:29,699 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:08:29,699 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:09:47,141 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:09:47,142 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:09:47,142 - innolab - INFO - ======================================================================
2025-08-25 14:09:47,142 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:09:47,143 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:09:47,143 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:09:47,144 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140831.log
2025-08-25 14:09:47,144 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:09:47,144 - innolab - INFO - Issues found in 0 files
2025-08-25 14:09:47,145 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140831.log
2025-08-25 14:09:47,145 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:09:47,145 - innolab - INFO - Scan Results:
2025-08-25 14:09:47,146 - innolab - INFO - Directory: source_bug
2025-08-25 14:09:47,146 - innolab - INFO - Found 11 code files
2025-08-25 14:09:47,147 - innolab - INFO - Files to process:
2025-08-25 14:09:47,147 - innolab - INFO - 1. appy.py
2025-08-25 14:09:47,148 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:09:47,148 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:09:47,148 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:09:47,149 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:09:47,149 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:09:47,149 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:09:47,150 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:09:47,150 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:09:47,150 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:09:47,151 - innolab - INFO - ... and 1 more files
2025-08-25 14:09:47,151 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:09:47,151 - innolab - INFO - ======================================================================
2025-08-25 14:09:47,151 - innolab - INFO - Starting secure fixing...
2025-08-25 14:09:47,152 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_140831.log
2025-08-25 14:09:47,152 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:09:47,153 - innolab - INFO - Success (8.6s)
2025-08-25 14:09:47,153 - innolab - INFO - Changes: Size change: 319 bytes; Similarity: 92.7%
2025-08-25 14:09:47,154 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:09:47,154 - innolab - INFO - Success (2.6s)
2025-08-25 14:09:47,155 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:09:47,155 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:09:47,156 - innolab - INFO - Success (5.3s)
2025-08-25 14:09:47,156 - innolab - INFO - Changes: Size change: -200 bytes; Similarity: 78.4%
2025-08-25 14:09:47,157 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:09:47,158 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:09:47,158 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:09:47,159 - innolab - INFO - Failed: Syntax validation failed: Line 21: Missing semicolon
2025-08-25 14:09:47,159 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:09:47,159 - innolab - INFO - Success (5.8s)
2025-08-25 14:09:47,160 - innolab - INFO - Changes: Size change: -107 bytes; Similarity: 79.3%
2025-08-25 14:09:47,161 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:09:47,161 - innolab - INFO - Success (2.7s)
2025-08-25 14:09:47,162 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:09:47,162 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:09:47,163 - innolab - INFO - Success (7.5s)
2025-08-25 14:09:47,163 - innolab - INFO - Changes: Size change: -97 bytes; Similarity: 93.0%
2025-08-25 14:09:47,164 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:09:47,164 - innolab - INFO - Success (5.7s)
2025-08-25 14:09:47,165 - innolab - INFO - Changes: Size change: 38 bytes; Similarity: 93.2%
2025-08-25 14:09:47,166 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:09:47,166 - innolab - INFO - Success (6.1s)
2025-08-25 14:09:47,166 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:09:47,167 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:09:47,167 - innolab - INFO - Success (5.5s)
2025-08-25 14:09:47,168 - innolab - INFO - Changes: Size change: 49 bytes; Similarity: 98.0%
2025-08-25 14:09:47,168 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:09:47,169 - innolab - INFO - Success (3.4s)
2025-08-25 14:09:47,169 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:09:47,170 - innolab - INFO - ======================================================================
2025-08-25 14:09:47,170 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:09:47,170 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:09:47,170 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:09:47,171 - innolab - INFO - TOTAL_INPUT_TOKENS: 10194
2025-08-25 14:09:47,171 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 8056
2025-08-25 14:09:47,171 - innolab - INFO - TOTAL_TOKENS: 18250
2025-08-25 14:09:47,172 - innolab - INFO - AVERAGE_SIMILARITY: 0.935
2025-08-25 14:09:47,173 - innolab - INFO - THRESHOLD_MET_COUNT: 8
2025-08-25 14:09:47,173 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:09:47,174 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:09:47,175 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 0.927 | INPUT_TOKENS: 1451 | OUTPUT_TOKENS: 1373 | TOTAL_TOKENS: 2824 | THRESHOLD_MET: True
2025-08-25 14:09:47,175 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 818 | OUTPUT_TOKENS: 318 | TOTAL_TOKENS: 1136 | THRESHOLD_MET: True
2025-08-25 14:09:47,175 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.784 | INPUT_TOKENS: 1237 | OUTPUT_TOKENS: 853 | TOTAL_TOKENS: 2090 | THRESHOLD_MET: False
2025-08-25 14:09:47,175 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:09:47,175 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 0.793 | INPUT_TOKENS: 931 | OUTPUT_TOKENS: 964 | TOTAL_TOKENS: 1895 | THRESHOLD_MET: False
2025-08-25 14:09:47,176 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 386 | TOTAL_TOKENS: 1179 | THRESHOLD_MET: True
2025-08-25 14:09:47,176 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.930 | INPUT_TOKENS: 1219 | OUTPUT_TOKENS: 1195 | TOTAL_TOKENS: 2414 | THRESHOLD_MET: True
2025-08-25 14:09:47,177 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.932 | INPUT_TOKENS: 1046 | OUTPUT_TOKENS: 879 | TOTAL_TOKENS: 1925 | THRESHOLD_MET: True
2025-08-25 14:09:47,178 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 842 | TOTAL_TOKENS: 1795 | THRESHOLD_MET: True
2025-08-25 14:09:47,178 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 0.980 | INPUT_TOKENS: 1021 | OUTPUT_TOKENS: 828 | TOTAL_TOKENS: 1849 | THRESHOLD_MET: True
2025-08-25 14:09:47,179 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 418 | TOTAL_TOKENS: 1143 | THRESHOLD_MET: True
2025-08-25 14:09:47,180 - innolab - INFO - AVERAGE_PROCESSING_TIME: 6.9
2025-08-25 14:09:47,180 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:09:49,332 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:09:49,333 - innolab - INFO - Token usage - Input: 10194, Output: 8056, Total: 18250
2025-08-25 14:09:49,333 - innolab - INFO - Average similarity: 0.935, Threshold met: 8
2025-08-25 14:09:49,334 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:09:49,335 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:09:49,335 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:09:49,336 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:09:49,337 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:09:49,337 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:09:49,338 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:09:49,338 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:09:49,339 - innolab - INFO - Iteration 5 completed: 3 bugs remain after rescan
2025-08-25 14:09:49,339 - innolab - INFO - === EXECUTION RESULT ===
2025-08-25 14:09:49,340 - innolab - INFO - Mode: LOCAL
2025-08-25 14:09:49,340 - innolab - INFO - Project: my-service
2025-08-25 14:09:49,340 - innolab - INFO - Total bugs fixed: 50
2025-08-25 14:09:49,341 - innolab - INFO - Total iterations: 5
2025-08-25 14:09:49,341 - innolab - INFO - Start time: 2025-08-25T14:01:55.296757
2025-08-25 14:09:49,342 - innolab - INFO - End time: 2025-08-25T14:09:49.339576
2025-08-25 14:09:49,342 - innolab - INFO - Iteration 1: 3 bugs found, 10 fixed
2025-08-25 14:09:49,343 - innolab - INFO - Iteration 2: 3 bugs found, 10 fixed
2025-08-25 14:09:49,343 - innolab - INFO - Iteration 3: 3 bugs found, 10 fixed
2025-08-25 14:09:49,343 - innolab - INFO - Iteration 4: 3 bugs found, 10 fixed
2025-08-25 14:09:49,345 - innolab - INFO - Iteration 5: 3 bugs found, 10 fixed
