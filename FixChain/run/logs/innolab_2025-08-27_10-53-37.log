2025-08-27 10:53:37,493 - innolab - INFO - ExecutionServiceNoMongo initialized with:
2025-08-27 10:53:37,493 - innolab - INFO -   Max iterations: 5
2025-08-27 10:53:37,493 - innolab - INFO -   Project key: my-service
2025-08-27 10:53:37,493 - innolab - INFO -   Source code path: c:\Users\HieuLT\Desktop\InnoLab\projects
2025-08-27 10:53:37,493 - innolab - INFO -   Scan directory: Flask_App
2025-08-27 10:53:37,493 - innolab - INFO -   Scan mode: ['bearer']
2025-08-27 10:53:37,493 - innolab - INFO -   Fix mode: ['llm']
2025-08-27 10:53:37,493 - innolab - INFO -   RAG available: True
2025-08-27 10:53:37,496 - innolab - INFO - Starting execution without RAG (mode: DifyMode.LOCAL)
2025-08-27 10:53:37,496 - innolab - INFO - 
=== ITERATION 1/5 ===
2025-08-27 10:53:37,496 - innolab - INFO - Starting Bearer scan for project: my-service
2025-08-27 10:53:37,496 - innolab - INFO - Scanning directory: c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App
2025-08-27 10:53:37,498 - innolab - ERROR - Command not found: bearer
2025-08-27 10:53:37,498 - innolab - INFO - Using Bearer Docker image
2025-08-27 10:53:37,498 - innolab - INFO - Running Bearer Docker scan: docker run --rm -v c:\Users\HieuLT\Desktop\InnoLab\projects\Flask_App:/scan -v c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results:/output bearer/bearer:latest scan /scan --format json --output /output/bearer_results_my-service.json --quiet --skip-path node_modules,*.git,__pycache__,.venv,venv,dist,build
2025-08-27 10:53:38,587 - innolab - INFO - Analyzing codebase
2025-08-27 10:53:45,563 - innolab - ERROR - Command failed with return code 1
2025-08-27 10:53:45,564 - innolab - INFO - Bearer Docker scan completed successfully
2025-08-27 10:53:45,565 - innolab - INFO - Reading Bearer scan results from: c:\Users\HieuLT\Desktop\InnoLab\projects\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-27 10:53:45,566 - innolab - INFO - Bearer scan results loaded successfully
2025-08-27 10:53:45,566 - innolab - INFO - Found 5 Bearer security issues
2025-08-27 10:53:45,566 - innolab - INFO - BEARER scanner found 5 bugs
2025-08-27 10:53:45,567 - innolab - INFO - Iteration 1: Found 5 open bugs (0 BUG, 0 CODE_SMELL) across scanners: BEARER
2025-08-27 10:53:45,567 - innolab - ERROR - Scan directory not found: C:\Users\HieuLT\Desktop\InnoLab\Flask_App
2025-08-27 10:53:45,568 - innolab - INFO - Need to fix 5 bugs using Dify
2025-08-27 10:53:45,568 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-27 10:53:45,568 - innolab - INFO - User: hieult
2025-08-27 10:53:45,569 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-27 10:53:45,569 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-27 10:53:45,570 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-27 10:53:45,571 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'src': '', 'report': '[{"key": "bearer_python_lang_avoid_pickle_3d8bc9945ac20db0da36e3db83cdb41a_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "owasp_insecure_demo.py", "line": 167, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "security", "medium", "cwe-502"], "creationDate": "2025-08-27T10:53:45.566452", "updateDate": "2025-08-27T10:53:45.566461", "textRange": {"startLine": 167, "endLine": 167, "startOffset": 15, "endOffset": 33}}, {"key": "bearer_python_lang_ssl_verification_75c7b3a22c569565d6a6ddca3576a54f_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "owasp_insecure_demo.py", "line": 179, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "security", "medium", "cwe-295"], "creationDate": "2025-08-27T10:53:45.566522", "updateDate": "2025-08-27T10:53:45.566525", "textRange": {"startLine": 179, "endLine": 179, "startOffset": 13, "endOffset": 55}}, {"key": "bearer_python_lang_weak_hash_md5_067dd1abb0e02d41f260b99c894ed303_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "owasp_insecure_demo.py", "line": 41, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "security", "medium", "cwe-328"], "creationDate": "2025-08-27T10:53:45.566567", "updateDate": "2025-08-27T10:53:45.566569", "textRange": {"startLine": 41, "endLine": 41, "startOffset": 18, "endOffset": 42}}, {"key": "bearer_python_lang_weak_hash_md5_067dd1abb0e02d41f260b99c894ed303_1", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "owasp_insecure_demo.py", "line": 74, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "security", "medium", "cwe-328"], "creationDate": "2025-08-27T10:53:45.566597", "updateDate": "2025-08-27T10:53:45.566599", "textRange": {"startLine": 74, "endLine": 74, "startOffset": 14, "endOffset": 44}}, {"key": "bearer_python_lang_weak_hash_md5_067dd1abb0e02d41f260b99c894ed303_2", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "owasp_insecure_demo.py", "line": 90, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "security", "medium", "cwe-328"], "creationDate": "2025-08-27T10:53:45.566630", "updateDate": "2025-08-27T10:53:45.566632", "textRange": {"startLine": 90, "endLine": 90, "startOffset": 14, "endOffset": 44}}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-27 10:53:46,906 - innolab - INFO - Dify workflow run response status: 200
2025-08-27 10:53:46,907 - innolab - INFO - Dify workflow run response: {"task_id": "7c21ae43-dc0f-448f-b5fc-4cc0acc064fc", "workflow_run_id": "39d6e81a-1611-4989-a456-bfbb1024a298", "data": {"id": "39d6e81a-1611-4989-a456-bfbb1024a298", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "failed", "outputs": {}, "error": "[google] Error: req_id: ae76799901 PluginInvokeError: {\"args\":{},\"error_type\":\"ClientError\",\"message\":\"429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_content_free_tier_requests', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel-FreeTier', 'quotaDimensions': {'location': 'global', 'model': 'gemini-2.0-flash'}, 'quotaValue': '200'}]}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.RetryInfo', 'retryDelay': '13s'}]}}\"}", "elapsed_time": 1.195885, "total_tokens": 0, "total_steps": 3, "created_at": 1756266825, "finished_at": 1756266826}}
2025-08-27 10:53:46,907 - innolab - INFO - DIFY: list_bugs type: <class 'str'>, content: 
2025-08-27 10:53:46,908 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 0
2025-08-27 10:53:46,908 - innolab - ERROR - Failed to parse list_real_bugs as JSON: Expecting value: line 1 column 1 (char 0)
2025-08-27 10:53:46,908 - innolab - INFO - No real bugs to fix after analysis
2025-08-27 10:53:46,909 - innolab - INFO - === EXECUTION RESULT ===
2025-08-27 10:53:46,909 - innolab - INFO - Mode: LOCAL
2025-08-27 10:53:46,909 - innolab - INFO - Project: my-service
2025-08-27 10:53:46,910 - innolab - INFO - Total bugs fixed: 0
2025-08-27 10:53:46,910 - innolab - INFO - Total iterations: 1
2025-08-27 10:53:46,910 - innolab - INFO - Start time: 2025-08-27T10:53:37.496011
2025-08-27 10:53:46,910 - innolab - INFO - End time: 2025-08-27T10:53:46.909071
2025-08-27 10:53:46,910 - innolab - INFO - Iteration 1: 5 bugs found, 0 fixed
