2025-08-25 14:44:00,826 - innolab - INFO - ExecutionServiceNoMongo initialized with:
2025-08-25 14:44:00,826 - innolab - INFO -   Max iterations: 5
2025-08-25 14:44:00,826 - innolab - INFO -   Project key: my-service
2025-08-25 14:44:00,827 - innolab - INFO -   Source code path: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:44:00,827 - innolab - INFO -   Scan directory: source_bug
2025-08-25 14:44:00,827 - innolab - INFO -   Scan mode: bearer
2025-08-25 14:44:00,827 - innolab - INFO -   RAG available: True
2025-08-25 14:44:00,827 - innolab - INFO - Starting execution without RAG (mode: DifyMode.LOCAL)
2025-08-25 14:44:00,827 - innolab - INFO - 
=== ITERATION 1/5 ===
2025-08-25 14:44:00,828 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:44:00,828 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:44:00,829 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:44:00,829 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:44:00,829 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:44:00,829 - innolab - INFO - Iteration 1: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:44:00,829 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:44:00,829 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:44:00,829 - innolab - INFO - User: hieult
2025-08-25 14:44:00,830 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:44:00,830 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:44:00,830 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:44:00,830 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:44:00.829215", "updateDate": "2025-08-25T14:44:00.829220", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:44:00.829247", "updateDate": "2025-08-25T14:44:00.829248", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:44:00.829262", "updateDate": "2025-08-25T14:44:00.829263", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:44:07,033 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:44:07,033 - innolab - INFO - Dify workflow run response: {"task_id": "ee583014-14c4-4c01-bde1-dc7f3ebebbb3", "workflow_run_id": "59419432-4039-45ce-8a68-5778e6f5c9bd", "data": {"id": "59419432-4039-45ce-8a68-5778e6f5c9bd", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. This is a security risk.", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. This is a security risk.", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. This is a security risk.", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. This is a security risk.\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. This is a security risk.\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. This is a security risk.\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 5.568008, "total_tokens": 3512, "total_steps": 4, "created_at": 1756107841, "finished_at": 1756107846}}
2025-08-25 14:44:07,034 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. This is a security risk.', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. This is a security risk.', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. This is a security risk.', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:44:07,035 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:44:07,035 - innolab - INFO - Starting fix_bugs for 2 bugs
2025-08-25 14:44:07,035 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:44:07,038 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:44:07,038 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:45:34,874 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:45:34,875 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:45:34,875 - innolab - INFO - ======================================================================
2025-08-25 14:45:34,876 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:45:34,876 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:45:34,877 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:45:34,877 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144408.log
2025-08-25 14:45:34,878 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:45:34,878 - innolab - INFO - Issues found in 0 files
2025-08-25 14:45:34,879 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144408.log
2025-08-25 14:45:34,879 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:45:34,880 - innolab - INFO - Scan Results:
2025-08-25 14:45:34,880 - innolab - INFO - Directory: source_bug
2025-08-25 14:45:34,881 - innolab - INFO - Found 11 code files
2025-08-25 14:45:34,881 - innolab - INFO - Files to process:
2025-08-25 14:45:34,882 - innolab - INFO - 1. appy.py
2025-08-25 14:45:34,882 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:45:34,883 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:45:34,883 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:45:34,884 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:45:34,884 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:45:34,884 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:45:34,884 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:45:34,885 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:45:34,885 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:45:34,886 - innolab - INFO - ... and 1 more files
2025-08-25 14:45:34,886 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:45:34,887 - innolab - INFO - ======================================================================
2025-08-25 14:45:34,887 - innolab - INFO - Starting secure fixing...
2025-08-25 14:45:34,887 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144408.log
2025-08-25 14:45:34,887 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:45:34,888 - innolab - INFO - Success (14.3s)
2025-08-25 14:45:34,888 - innolab - INFO - Changes: Size change: 124 bytes; Similarity: 97.9%
2025-08-25 14:45:34,888 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:45:34,889 - innolab - INFO - Success (3.8s)
2025-08-25 14:45:34,889 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:45:34,889 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:45:34,890 - innolab - INFO - Success (6.8s)
2025-08-25 14:45:34,890 - innolab - INFO - Changes: Size change: 336 bytes; Similarity: 86.7%
2025-08-25 14:45:34,890 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:45:34,890 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:45:34,890 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:45:34,891 - innolab - INFO - Failed: Syntax validation failed: Line 21: Missing semicolon
2025-08-25 14:45:34,891 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:45:34,891 - innolab - INFO - Success (7.7s)
2025-08-25 14:45:34,891 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:45:34,891 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:45:34,892 - innolab - INFO - Success (3.3s)
2025-08-25 14:45:34,892 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:45:34,893 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:45:34,893 - innolab - INFO - Success (7.4s)
2025-08-25 14:45:34,893 - innolab - INFO - Changes: Size change: 230 bytes; Similarity: 92.1%
2025-08-25 14:45:34,893 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:45:34,893 - innolab - INFO - Success (6.4s)
2025-08-25 14:45:34,894 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:45:34,894 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:45:34,894 - innolab - INFO - Success (6.8s)
2025-08-25 14:45:34,894 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:45:34,894 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:45:34,894 - innolab - INFO - Success (4.6s)
2025-08-25 14:45:34,895 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 98.6%
2025-08-25 14:45:34,895 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:45:34,895 - innolab - INFO - Success (2.7s)
2025-08-25 14:45:34,895 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:45:34,895 - innolab - INFO - ======================================================================
2025-08-25 14:45:34,895 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:45:34,895 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:45:34,896 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:45:34,896 - innolab - INFO - TOTAL_INPUT_TOKENS: 10170
2025-08-25 14:45:34,896 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 9105
2025-08-25 14:45:34,896 - innolab - INFO - TOTAL_TOKENS: 19275
2025-08-25 14:45:34,896 - innolab - INFO - AVERAGE_SIMILARITY: 0.975
2025-08-25 14:45:34,897 - innolab - INFO - THRESHOLD_MET_COUNT: 10
2025-08-25 14:45:34,897 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:45:34,897 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:45:34,897 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 0.979 | INPUT_TOKENS: 1538 | OUTPUT_TOKENS: 1979 | TOTAL_TOKENS: 3517 | THRESHOLD_MET: True
2025-08-25 14:45:34,897 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 818 | OUTPUT_TOKENS: 454 | TOTAL_TOKENS: 1272 | THRESHOLD_MET: True
2025-08-25 14:45:34,898 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.867 | INPUT_TOKENS: 1164 | OUTPUT_TOKENS: 1015 | TOTAL_TOKENS: 2179 | THRESHOLD_MET: True
2025-08-25 14:45:34,898 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:45:34,898 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 914 | OUTPUT_TOKENS: 1176 | TOTAL_TOKENS: 2090 | THRESHOLD_MET: True
2025-08-25 14:45:34,898 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 388 | TOTAL_TOKENS: 1181 | THRESHOLD_MET: True
2025-08-25 14:45:34,899 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.921 | INPUT_TOKENS: 1180 | OUTPUT_TOKENS: 1234 | TOTAL_TOKENS: 2414 | THRESHOLD_MET: True
2025-08-25 14:45:34,899 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1054 | OUTPUT_TOKENS: 895 | TOTAL_TOKENS: 1949 | THRESHOLD_MET: True
2025-08-25 14:45:34,899 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 1058 | TOTAL_TOKENS: 2011 | THRESHOLD_MET: True
2025-08-25 14:45:34,899 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 0.986 | INPUT_TOKENS: 1031 | OUTPUT_TOKENS: 632 | TOTAL_TOKENS: 1663 | THRESHOLD_MET: True
2025-08-25 14:45:34,899 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 274 | TOTAL_TOKENS: 999 | THRESHOLD_MET: True
2025-08-25 14:45:34,899 - innolab - INFO - AVERAGE_PROCESSING_TIME: 7.8
2025-08-25 14:45:34,899 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:45:34,899 - innolab - INFO - {"success": true, "fixed_count": 10, "failed_count": 1, "total_input_tokens": 10170, "total_output_tokens": 9105, "total_tokens": 19275, "average_similarity": 0.9753137695357932, "threshold_met_count": 10, "similarity_threshold": 0.85, "average_processing_time": 7.840177272727273}
2025-08-25 14:45:37,060 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:45:37,060 - innolab - INFO - Token usage - Input: 10170, Output: 9105, Total: 19275
2025-08-25 14:45:37,061 - innolab - INFO - Average similarity: 0.975, Threshold met: 10
2025-08-25 14:45:37,062 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:45:37,062 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:45:37,062 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:45:37,063 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:45:37,064 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:45:37,064 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:45:37,065 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:45:37,065 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:45:37,066 - innolab - INFO - Iteration 1 completed: 3 bugs remain after rescan
2025-08-25 14:45:37,066 - innolab - INFO - 
=== ITERATION 2/5 ===
2025-08-25 14:45:37,067 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:45:37,067 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:45:37,068 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:45:37,069 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:45:37,069 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:45:37,070 - innolab - INFO - Iteration 2: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:45:37,070 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:45:37,070 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:45:37,071 - innolab - INFO - User: hieult
2025-08-25 14:45:37,071 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:45:37,071 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:45:37,072 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:45:37,072 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:45:37.069077", "updateDate": "2025-08-25T14:45:37.069084", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:45:37.069131", "updateDate": "2025-08-25T14:45:37.069133", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:45:37.069163", "updateDate": "2025-08-25T14:45:37.069165", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:45:43,698 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:45:43,699 - innolab - INFO - Dify workflow run response: {"task_id": "9c3ac8c7-5a2e-4c72-9f9f-5bb487885584", "workflow_run_id": "024fd6a3-3db0-4beb-9867-43861efd0047", "data": {"id": "024fd6a3-3db0-4beb-9867-43861efd0047", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 6.373242, "total_tokens": 3533, "total_steps": 4, "created_at": 1756107937, "finished_at": 1756107943}}
2025-08-25 14:45:43,701 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:45:43,701 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:45:43,702 - innolab - INFO - Starting fix_bugs for 2 bugs
2025-08-25 14:45:43,703 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:45:43,704 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:45:43,705 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:47:06,491 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:47:06,496 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:47:06,496 - innolab - INFO - ======================================================================
2025-08-25 14:47:06,497 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:47:06,497 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:47:06,498 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:47:06,499 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144545.log
2025-08-25 14:47:06,499 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:47:06,499 - innolab - INFO - Issues found in 0 files
2025-08-25 14:47:06,499 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144545.log
2025-08-25 14:47:06,499 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:47:06,500 - innolab - INFO - Scan Results:
2025-08-25 14:47:06,500 - innolab - INFO - Directory: source_bug
2025-08-25 14:47:06,500 - innolab - INFO - Found 11 code files
2025-08-25 14:47:06,500 - innolab - INFO - Files to process:
2025-08-25 14:47:06,500 - innolab - INFO - 1. appy.py
2025-08-25 14:47:06,500 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:47:06,500 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:47:06,500 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:47:06,501 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:47:06,501 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:47:06,501 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:47:06,501 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:47:06,501 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:47:06,501 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:47:06,501 - innolab - INFO - ... and 1 more files
2025-08-25 14:47:06,501 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:47:06,501 - innolab - INFO - ======================================================================
2025-08-25 14:47:06,501 - innolab - INFO - Starting secure fixing...
2025-08-25 14:47:06,501 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144545.log
2025-08-25 14:47:06,502 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:47:06,502 - innolab - INFO - Success (9.8s)
2025-08-25 14:47:06,502 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:47:06,502 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:47:06,502 - innolab - INFO - Success (4.5s)
2025-08-25 14:47:06,502 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:47:06,502 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:47:06,502 - innolab - INFO - Success (6.9s)
2025-08-25 14:47:06,502 - innolab - INFO - Changes: Size change: -62 bytes; Similarity: 98.3%
2025-08-25 14:47:06,503 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:47:06,503 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:47:06,503 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:47:06,503 - innolab - INFO - Failed: Syntax validation failed: Line 20: Missing semicolon
2025-08-25 14:47:06,503 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:47:06,503 - innolab - INFO - Success (4.9s)
2025-08-25 14:47:06,503 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:47:06,503 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:47:06,503 - innolab - INFO - Success (2.8s)
2025-08-25 14:47:06,503 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:47:06,503 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:47:06,503 - innolab - INFO - Success (10.4s)
2025-08-25 14:47:06,503 - innolab - INFO - Changes: Size change: 77 bytes; Similarity: 93.9%
2025-08-25 14:47:06,503 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:47:06,503 - innolab - INFO - Success (6.5s)
2025-08-25 14:47:06,503 - innolab - INFO - Changes: Size change: 57 bytes; Similarity: 97.8%
2025-08-25 14:47:06,503 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:47:06,503 - innolab - INFO - Success (8.4s)
2025-08-25 14:47:06,503 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:47:06,504 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:47:06,504 - innolab - INFO - Success (5.3s)
2025-08-25 14:47:06,504 - innolab - INFO - Changes: Size change: -2 bytes; Similarity: 95.9%
2025-08-25 14:47:06,504 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:47:06,504 - innolab - INFO - Success (2.7s)
2025-08-25 14:47:06,504 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:47:06,504 - innolab - INFO - ======================================================================
2025-08-25 14:47:06,504 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:47:06,504 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:47:06,504 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:47:06,504 - innolab - INFO - TOTAL_INPUT_TOKENS: 10336
2025-08-25 14:47:06,505 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 8753
2025-08-25 14:47:06,505 - innolab - INFO - TOTAL_TOKENS: 19089
2025-08-25 14:47:06,505 - innolab - INFO - AVERAGE_SIMILARITY: 0.986
2025-08-25 14:47:06,505 - innolab - INFO - THRESHOLD_MET_COUNT: 10
2025-08-25 14:47:06,505 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:47:06,505 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:47:06,506 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1570 | OUTPUT_TOKENS: 1532 | TOTAL_TOKENS: 3102 | THRESHOLD_MET: True
2025-08-25 14:47:06,506 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 818 | OUTPUT_TOKENS: 488 | TOTAL_TOKENS: 1306 | THRESHOLD_MET: True
2025-08-25 14:47:06,506 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.983 | INPUT_TOKENS: 1235 | OUTPUT_TOKENS: 995 | TOTAL_TOKENS: 2230 | THRESHOLD_MET: True
2025-08-25 14:47:06,506 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:47:06,507 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 914 | OUTPUT_TOKENS: 659 | TOTAL_TOKENS: 1573 | THRESHOLD_MET: True
2025-08-25 14:47:06,507 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 323 | TOTAL_TOKENS: 1116 | THRESHOLD_MET: True
2025-08-25 14:47:06,507 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.939 | INPUT_TOKENS: 1242 | OUTPUT_TOKENS: 1456 | TOTAL_TOKENS: 2698 | THRESHOLD_MET: True
2025-08-25 14:47:06,507 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.978 | INPUT_TOKENS: 1054 | OUTPUT_TOKENS: 799 | TOTAL_TOKENS: 1853 | THRESHOLD_MET: True
2025-08-25 14:47:06,507 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 1439 | TOTAL_TOKENS: 2392 | THRESHOLD_MET: True
2025-08-25 14:47:06,508 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 0.959 | INPUT_TOKENS: 1032 | OUTPUT_TOKENS: 833 | TOTAL_TOKENS: 1865 | THRESHOLD_MET: True
2025-08-25 14:47:06,508 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 229 | TOTAL_TOKENS: 954 | THRESHOLD_MET: True
2025-08-25 14:47:06,508 - innolab - INFO - AVERAGE_PROCESSING_TIME: 7.4
2025-08-25 14:47:06,508 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:47:06,508 - innolab - INFO - {"success": true, "fixed_count": 10, "failed_count": 1, "total_input_tokens": 10336, "total_output_tokens": 8753, "total_tokens": 19089, "average_similarity": 0.9858405054182781, "threshold_met_count": 10, "similarity_threshold": 0.85, "average_processing_time": 7.402242363636364}
2025-08-25 14:47:08,670 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:47:08,671 - innolab - INFO - Token usage - Input: 10336, Output: 8753, Total: 19089
2025-08-25 14:47:08,671 - innolab - INFO - Average similarity: 0.986, Threshold met: 10
2025-08-25 14:47:08,672 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:47:08,672 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:47:08,673 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:47:08,674 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:47:08,674 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:47:08,675 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:47:08,675 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:47:08,675 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:47:08,676 - innolab - INFO - Iteration 2 completed: 3 bugs remain after rescan
2025-08-25 14:47:08,676 - innolab - INFO - 
=== ITERATION 3/5 ===
2025-08-25 14:47:08,676 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:47:08,677 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:47:08,677 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:47:08,678 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:47:08,679 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:47:08,679 - innolab - INFO - Iteration 3: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:47:08,679 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:47:08,680 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:47:08,680 - innolab - INFO - User: hieult
2025-08-25 14:47:08,680 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:47:08,681 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:47:08,681 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:47:08,681 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:47:08.678511", "updateDate": "2025-08-25T14:47:08.678521", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:47:08.678575", "updateDate": "2025-08-25T14:47:08.678577", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:47:08.678609", "updateDate": "2025-08-25T14:47:08.678610", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:47:14,411 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:47:14,411 - innolab - INFO - Dify workflow run response: {"task_id": "db9a37cd-b3ac-48c5-9593-398c760209bc", "workflow_run_id": "6088a215-8c27-4516-8ff3-f0bbd801d6eb", "data": {"id": "6088a215-8c27-4516-8ff3-f0bbd801d6eb", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 5.579727, "total_tokens": 3533, "total_steps": 4, "created_at": 1756108028, "finished_at": 1756108034}}
2025-08-25 14:47:14,412 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:47:14,412 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:47:14,412 - innolab - INFO - Starting fix_bugs for 2 bugs
2025-08-25 14:47:14,412 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:47:14,414 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:47:14,414 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:48:31,529 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:48:31,530 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:48:31,531 - innolab - INFO - ======================================================================
2025-08-25 14:48:31,531 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:48:31,532 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:48:31,533 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:48:31,533 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144715.log
2025-08-25 14:48:31,533 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:48:31,533 - innolab - INFO - Issues found in 0 files
2025-08-25 14:48:31,535 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144715.log
2025-08-25 14:48:31,535 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:48:31,535 - innolab - INFO - Scan Results:
2025-08-25 14:48:31,536 - innolab - INFO - Directory: source_bug
2025-08-25 14:48:31,536 - innolab - INFO - Found 11 code files
2025-08-25 14:48:31,537 - innolab - INFO - Files to process:
2025-08-25 14:48:31,537 - innolab - INFO - 1. appy.py
2025-08-25 14:48:31,537 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:48:31,538 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:48:31,539 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:48:31,539 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:48:31,539 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:48:31,539 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:48:31,539 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:48:31,539 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:48:31,540 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:48:31,540 - innolab - INFO - ... and 1 more files
2025-08-25 14:48:31,540 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:48:31,540 - innolab - INFO - ======================================================================
2025-08-25 14:48:31,540 - innolab - INFO - Starting secure fixing...
2025-08-25 14:48:31,540 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144715.log
2025-08-25 14:48:31,540 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:48:31,541 - innolab - INFO - Success (8.1s)
2025-08-25 14:48:31,541 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:48:31,541 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:48:31,542 - innolab - INFO - Success (2.4s)
2025-08-25 14:48:31,542 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:48:31,542 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:48:31,542 - innolab - INFO - Success (6.5s)
2025-08-25 14:48:31,542 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:48:31,542 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:48:31,542 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:48:31,542 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:48:31,542 - innolab - INFO - Failed: Syntax validation failed: Line 20: Missing semicolon
2025-08-25 14:48:31,542 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:48:31,542 - innolab - INFO - Success (4.0s)
2025-08-25 14:48:31,542 - innolab - INFO - Changes: Size change: -66 bytes; Similarity: 95.6%
2025-08-25 14:48:31,542 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:48:31,542 - innolab - INFO - Success (2.6s)
2025-08-25 14:48:31,542 - innolab - INFO - Changes: Size change: 3 bytes; Similarity: 99.4%
2025-08-25 14:48:31,543 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:48:31,543 - innolab - INFO - Success (9.6s)
2025-08-25 14:48:31,543 - innolab - INFO - Changes: Size change: 189 bytes; Similarity: 95.8%
2025-08-25 14:48:31,543 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:48:31,543 - innolab - INFO - Success (6.6s)
2025-08-25 14:48:31,543 - innolab - INFO - Changes: Size change: 72 bytes; Similarity: 97.3%
2025-08-25 14:48:31,543 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:48:31,543 - innolab - INFO - Success (6.2s)
2025-08-25 14:48:31,543 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:48:31,543 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:48:31,543 - innolab - INFO - Success (5.5s)
2025-08-25 14:48:31,543 - innolab - INFO - Changes: Size change: 102 bytes; Similarity: 94.9%
2025-08-25 14:48:31,543 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:48:31,543 - innolab - INFO - Success (2.1s)
2025-08-25 14:48:31,543 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:48:31,543 - innolab - INFO - ======================================================================
2025-08-25 14:48:31,543 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:48:31,543 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:48:31,543 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:48:31,544 - innolab - INFO - TOTAL_INPUT_TOKENS: 10345
2025-08-25 14:48:31,544 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 7737
2025-08-25 14:48:31,544 - innolab - INFO - TOTAL_TOKENS: 18082
2025-08-25 14:48:31,544 - innolab - INFO - AVERAGE_SIMILARITY: 0.983
2025-08-25 14:48:31,544 - innolab - INFO - THRESHOLD_MET_COUNT: 10
2025-08-25 14:48:31,544 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:48:31,544 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:48:31,544 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1570 | OUTPUT_TOKENS: 1162 | TOTAL_TOKENS: 2732 | THRESHOLD_MET: True
2025-08-25 14:48:31,544 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 818 | OUTPUT_TOKENS: 290 | TOTAL_TOKENS: 1108 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1219 | OUTPUT_TOKENS: 913 | TOTAL_TOKENS: 2132 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 0.956 | INPUT_TOKENS: 914 | OUTPUT_TOKENS: 545 | TOTAL_TOKENS: 1459 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 0.994 | INPUT_TOKENS: 793 | OUTPUT_TOKENS: 333 | TOTAL_TOKENS: 1126 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.958 | INPUT_TOKENS: 1256 | OUTPUT_TOKENS: 1525 | TOTAL_TOKENS: 2781 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.973 | INPUT_TOKENS: 1067 | OUTPUT_TOKENS: 942 | TOTAL_TOKENS: 2009 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 952 | TOTAL_TOKENS: 1905 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 0.949 | INPUT_TOKENS: 1030 | OUTPUT_TOKENS: 869 | TOTAL_TOKENS: 1899 | THRESHOLD_MET: True
2025-08-25 14:48:31,545 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 206 | TOTAL_TOKENS: 931 | THRESHOLD_MET: True
2025-08-25 14:48:31,546 - innolab - INFO - AVERAGE_PROCESSING_TIME: 6.9
2025-08-25 14:48:31,546 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:48:31,546 - innolab - INFO - {"success": true, "fixed_count": 10, "failed_count": 1, "total_input_tokens": 10345, "total_output_tokens": 7737, "total_tokens": 18082, "average_similarity": 0.983036409931905, "threshold_met_count": 10, "similarity_threshold": 0.85, "average_processing_time": 6.8811100000000005}
2025-08-25 14:48:33,782 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:48:33,783 - innolab - INFO - Token usage - Input: 10345, Output: 7737, Total: 18082
2025-08-25 14:48:33,783 - innolab - INFO - Average similarity: 0.983, Threshold met: 10
2025-08-25 14:48:33,784 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:48:33,784 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:48:33,785 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:48:33,785 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:48:33,786 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:48:33,786 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:48:33,786 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:48:33,786 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:48:33,787 - innolab - INFO - Iteration 3 completed: 3 bugs remain after rescan
2025-08-25 14:48:33,787 - innolab - INFO - 
=== ITERATION 4/5 ===
2025-08-25 14:48:33,787 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:48:33,788 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:48:33,788 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:48:33,789 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:48:33,789 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:48:33,789 - innolab - INFO - Iteration 4: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:48:33,789 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:48:33,790 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:48:33,790 - innolab - INFO - User: hieult
2025-08-25 14:48:33,790 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:48:33,790 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:48:33,790 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:48:33,790 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:48:33.789032", "updateDate": "2025-08-25T14:48:33.789037", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:48:33.789065", "updateDate": "2025-08-25T14:48:33.789066", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:48:33.789082", "updateDate": "2025-08-25T14:48:33.789083", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:48:40,006 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:48:40,007 - innolab - INFO - Dify workflow run response: {"task_id": "da1b6d68-4e3d-4a62-b96b-d5a2018e81ac", "workflow_run_id": "7718f995-105b-4c04-a620-87f10b1837fd", "data": {"id": "7718f995-105b-4c04-a620-87f10b1837fd", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 6.141227, "total_tokens": 3533, "total_steps": 4, "created_at": 1756108113, "finished_at": 1756108119}}
2025-08-25 14:48:40,008 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:48:40,009 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:48:40,010 - innolab - INFO - Starting fix_bugs for 2 bugs
2025-08-25 14:48:40,011 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:48:40,012 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:48:40,013 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:50:02,802 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:50:02,802 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:50:02,803 - innolab - INFO - ======================================================================
2025-08-25 14:50:02,803 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:50:02,803 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:50:02,803 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:50:02,804 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144842.log
2025-08-25 14:50:02,804 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:50:02,804 - innolab - INFO - Issues found in 0 files
2025-08-25 14:50:02,805 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144842.log
2025-08-25 14:50:02,805 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:50:02,805 - innolab - INFO - Scan Results:
2025-08-25 14:50:02,805 - innolab - INFO - Directory: source_bug
2025-08-25 14:50:02,806 - innolab - INFO - Found 11 code files
2025-08-25 14:50:02,806 - innolab - INFO - Files to process:
2025-08-25 14:50:02,806 - innolab - INFO - 1. appy.py
2025-08-25 14:50:02,806 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:50:02,807 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:50:02,807 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:50:02,808 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:50:02,810 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:50:02,810 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:50:02,811 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:50:02,811 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:50:02,811 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:50:02,812 - innolab - INFO - ... and 1 more files
2025-08-25 14:50:02,812 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:50:02,812 - innolab - INFO - ======================================================================
2025-08-25 14:50:02,812 - innolab - INFO - Starting secure fixing...
2025-08-25 14:50:02,812 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_144842.log
2025-08-25 14:50:02,812 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:50:02,813 - innolab - INFO - Success (10.8s)
2025-08-25 14:50:02,813 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:50:02,813 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:50:02,813 - innolab - INFO - Success (4.4s)
2025-08-25 14:50:02,813 - innolab - INFO - Changes: Size change: 116 bytes; Similarity: 89.7%
2025-08-25 14:50:02,814 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:50:02,814 - innolab - INFO - Success (5.9s)
2025-08-25 14:50:02,814 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 99.9%
2025-08-25 14:50:02,814 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:50:02,815 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:50:02,815 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:50:02,815 - innolab - INFO - Failed: Syntax validation failed: Line 20: Missing semicolon
2025-08-25 14:50:02,816 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:50:02,816 - innolab - INFO - Success (4.5s)
2025-08-25 14:50:02,816 - innolab - INFO - Changes: Size change: 117 bytes; Similarity: 92.5%
2025-08-25 14:50:02,816 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:50:02,816 - innolab - INFO - Success (3.4s)
2025-08-25 14:50:02,817 - innolab - INFO - Changes: Size change: -90 bytes; Similarity: 80.3%
2025-08-25 14:50:02,817 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:50:02,817 - innolab - INFO - Success (10.3s)
2025-08-25 14:50:02,817 - innolab - INFO - Changes: Size change: 100 bytes; Similarity: 95.1%
2025-08-25 14:50:02,817 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:50:02,817 - innolab - INFO - Success (6.5s)
2025-08-25 14:50:02,817 - innolab - INFO - Changes: Size change: -115 bytes; Similarity: 90.7%
2025-08-25 14:50:02,817 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:50:02,817 - innolab - INFO - Success (6.1s)
2025-08-25 14:50:02,818 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:50:02,818 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:50:02,818 - innolab - INFO - Success (5.8s)
2025-08-25 14:50:02,818 - innolab - INFO - Changes: Size change: -11 bytes; Similarity: 89.9%
2025-08-25 14:50:02,818 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:50:02,818 - innolab - INFO - Success (2.7s)
2025-08-25 14:50:02,818 - innolab - INFO - Changes: Size change: 37 bytes; Similarity: 86.9%
2025-08-25 14:50:02,818 - innolab - INFO - ======================================================================
2025-08-25 14:50:02,818 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:50:02,819 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:50:02,819 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:50:02,819 - innolab - INFO - TOTAL_INPUT_TOKENS: 10432
2025-08-25 14:50:02,819 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 8605
2025-08-25 14:50:02,819 - innolab - INFO - TOTAL_TOKENS: 19037
2025-08-25 14:50:02,819 - innolab - INFO - AVERAGE_SIMILARITY: 0.925
2025-08-25 14:50:02,819 - innolab - INFO - THRESHOLD_MET_COUNT: 9
2025-08-25 14:50:02,819 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:50:02,819 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:50:02,819 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1570 | OUTPUT_TOKENS: 1618 | TOTAL_TOKENS: 3188 | THRESHOLD_MET: True
2025-08-25 14:50:02,819 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 0.897 | INPUT_TOKENS: 818 | OUTPUT_TOKENS: 582 | TOTAL_TOKENS: 1400 | THRESHOLD_MET: True
2025-08-25 14:50:02,819 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 0.999 | INPUT_TOKENS: 1219 | OUTPUT_TOKENS: 895 | TOTAL_TOKENS: 2114 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 0.925 | INPUT_TOKENS: 902 | OUTPUT_TOKENS: 625 | TOTAL_TOKENS: 1527 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 0.803 | INPUT_TOKENS: 795 | OUTPUT_TOKENS: 399 | TOTAL_TOKENS: 1194 | THRESHOLD_MET: False
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.951 | INPUT_TOKENS: 1318 | OUTPUT_TOKENS: 1444 | TOTAL_TOKENS: 2762 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.907 | INPUT_TOKENS: 1085 | OUTPUT_TOKENS: 874 | TOTAL_TOKENS: 1959 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 971 | TOTAL_TOKENS: 1924 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 0.899 | INPUT_TOKENS: 1047 | OUTPUT_TOKENS: 880 | TOTAL_TOKENS: 1927 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 0.869 | INPUT_TOKENS: 725 | OUTPUT_TOKENS: 317 | TOTAL_TOKENS: 1042 | THRESHOLD_MET: True
2025-08-25 14:50:02,820 - innolab - INFO - AVERAGE_PROCESSING_TIME: 7.3
2025-08-25 14:50:02,820 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:50:02,821 - innolab - INFO - {"success": true, "fixed_count": 10, "failed_count": 1, "total_input_tokens": 10432, "total_output_tokens": 8605, "total_tokens": 19037, "average_similarity": 0.9250723839147807, "threshold_met_count": 9, "similarity_threshold": 0.85, "average_processing_time": 7.340555454545455}
2025-08-25 14:50:05,041 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:50:05,042 - innolab - INFO - Token usage - Input: 10432, Output: 8605, Total: 19037
2025-08-25 14:50:05,042 - innolab - INFO - Average similarity: 0.925, Threshold met: 9
2025-08-25 14:50:05,044 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:50:05,044 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:50:05,044 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:50:05,045 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:50:05,046 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:50:05,046 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:50:05,047 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:50:05,047 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:50:05,047 - innolab - INFO - Iteration 4 completed: 3 bugs remain after rescan
2025-08-25 14:50:05,048 - innolab - INFO - 
=== ITERATION 5/5 ===
2025-08-25 14:50:05,048 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:50:05,048 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:50:05,049 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:50:05,049 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:50:05,049 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:50:05,050 - innolab - INFO - Iteration 5: Found 3 open bugs (0 BUG, 0 CODE_SMELL) in BEARER scan
2025-08-25 14:50:05,050 - innolab - INFO - Need to fix 3 bugs using Dify
2025-08-25 14:50:05,050 - innolab - INFO - Running workflow with Dify API: app-21rA0wUAaR7PKPdmCX2WJxMo
2025-08-25 14:50:05,050 - innolab - INFO - User: hieult
2025-08-25 14:50:05,050 - innolab - INFO - Mode: DifyMode.LOCAL
2025-08-25 14:50:05,051 - innolab - INFO - Base URL: http://localhost:5001/v1
2025-08-25 14:50:05,051 - innolab - INFO - Generating Dify headers for api_key: app-21...
2025-08-25 14:50:05,051 - innolab - INFO - POST http://localhost:5001/v1/workflows/run with payload: {'inputs': {'is_use_rag': 'False', 'report': '[{"key": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "rule": "python_lang_avoid_pickle", "severity": "BLOCKER", "component": "appy.py", "line": 48, "message": "Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "critical", "cwe-502"], "creationDate": "2025-08-25T14:50:05.049675", "updateDate": "2025-08-25T14:50:05.049681", "textRange": {"startLine": 48, "endLine": 48, "startOffset": 11, "endOffset": 29}, "scanner": "bearer", "bearer_severity": "critical", "cwe_ids": ["502"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_avoid_pickle", "code_extract": "    obj = pickle.loads(data)  # vulnerable"}, {"key": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "rule": "python_lang_ssl_verification", "severity": "CRITICAL", "component": "appy.py", "line": 64, "message": "Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "status": "OPEN", "type": "VULNERABILITY", "effort": "15min", "debt": "15min", "tags": ["security", "bearer", "high", "cwe-295"], "creationDate": "2025-08-25T14:50:05.049717", "updateDate": "2025-08-25T14:50:05.049718", "textRange": {"startLine": 64, "endLine": 64, "startOffset": 9, "endOffset": 40}, "scanner": "bearer", "bearer_severity": "high", "cwe_ids": ["295"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_ssl_verification", "code_extract": "    r = requests.get(url, verify=False)"}, {"key": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "rule": "python_lang_weak_hash_md5", "severity": "MAJOR", "component": "appy.py", "line": 55, "message": "Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "status": "OPEN", "type": "VULNERABILITY", "effort": "10min", "debt": "10min", "tags": ["security", "bearer", "medium", "cwe-328"], "creationDate": "2025-08-25T14:50:05.049741", "updateDate": "2025-08-25T14:50:05.049743", "textRange": {"startLine": 55, "endLine": 55, "startOffset": 9, "endOffset": 39}, "scanner": "bearer", "bearer_severity": "medium", "cwe_ids": ["328"], "documentation_url": "https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5", "code_extract": "    h = hashlib.md5(password.encode()).hexdigest()"}]'}, 'user': 'hieult', 'response_mode': 'blocking'}
2025-08-25 14:50:10,886 - innolab - INFO - Dify workflow run response status: 200
2025-08-25 14:50:10,887 - innolab - INFO - Dify workflow run response: {"task_id": "95f7e0a9-e886-4682-9e56-7f72606439ac", "workflow_run_id": "c50ff7c9-fd19-4026-8c40-38ebd83cbd20", "data": {"id": "c50ff7c9-fd19-4026-8c40-38ebd83cbd20", "workflow_id": "1ab32356-d6d5-4b3b-924e-5a66bb39ab5b", "status": "succeeded", "outputs": {"list_bugs": {"bugs": [{"action": "Fix", "bug_id": "bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0", "classification": "True Positive", "reason": "The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle", "rule_description": "Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...", "rule_key": "python_lang_avoid_pickle", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0", "classification": "True Positive", "reason": "The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification", "rule_description": "Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...", "rule_key": "python_lang_ssl_verification", "type": "vulnerability"}, {"action": "Fix", "bug_id": "bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0", "classification": "True Positive", "reason": "The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5", "rule_description": "Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...", "rule_key": "python_lang_weak_hash_md5", "type": "vulnerability"}], "bugs_to_fix": 3}, "bugs_to_fix": "{\n  \"bugs\": [\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle\",\n      \"rule_description\": \"Usage of unsafe Pickle libraries. ## Description\\n\\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...\",\n      \"rule_key\": \"python_lang_avoid_pickle\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification\",\n      \"rule_description\": \"Missing SSL certificate verification. ## Description\\n\\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...\",\n      \"rule_key\": \"python_lang_ssl_verification\",\n      \"type\": \"vulnerability\"\n    },\n    {\n      \"action\": \"Fix\",\n      \"bug_id\": \"bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0\",\n      \"classification\": \"True Positive\",\n      \"reason\": \"The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5\",\n      \"rule_description\": \"Usage of weak hashing library (MDx). ## Description\\n\\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...\",\n      \"rule_key\": \"python_lang_weak_hash_md5\",\n      \"type\": \"vulnerability\"\n    }\n  ],\n  \"bugs_to_fix\": 3\n}"}, "error": "", "elapsed_time": 5.694061, "total_tokens": 3533, "total_steps": 4, "created_at": 1756108205, "finished_at": 1756108210}}
2025-08-25 14:50:10,889 - innolab - INFO - DIFY: list_bugs type: <class 'dict'>, content: {'bugs': [{'action': 'Fix', 'bug_id': 'bearer_python_lang_avoid_pickle_dacfec7a132bf64e199a6d2ad0d36a87_0', 'classification': 'True Positive', 'reason': 'The code uses `pickle.loads`, which is known to be vulnerable to arbitrary code execution. RAG: bearer_python_lang_avoid_pickle', 'rule_description': 'Usage of unsafe Pickle libraries. ## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code ...', 'rule_key': 'python_lang_avoid_pickle', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_ssl_verification_d44c2edc9454db162c25339b54563d42_0', 'classification': 'True Positive', 'reason': 'The code disables SSL certificate verification, making it vulnerable to man-in-the-middle attacks. RAG: bearer_python_lang_ssl_verification', 'rule_description': 'Missing SSL certificate verification. ## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates ...', 'rule_key': 'python_lang_ssl_verification', 'type': 'vulnerability'}, {'action': 'Fix', 'bug_id': 'bearer_python_lang_weak_hash_md5_403b9d8f405ebbdf90685e618477f370_0', 'classification': 'True Positive', 'reason': 'The code uses MD5 for hashing, which is a weak hashing algorithm and vulnerable to collision attacks. RAG: bearer_python_lang_weak_hash_md5', 'rule_description': 'Usage of weak hashing library (MDx). ## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash valu...', 'rule_key': 'python_lang_weak_hash_md5', 'type': 'vulnerability'}], 'bugs_to_fix': 3}
2025-08-25 14:50:10,890 - innolab - INFO - DIFY: Initial bugs_to_fix from response: 3
2025-08-25 14:50:10,891 - innolab - INFO - Starting fix_bugs for 2 bugs
2025-08-25 14:50:10,891 - innolab - INFO - Fixing bugs in directory: d:\InnoLab\SonarQ\source_bug
2025-08-25 14:50:10,893 - innolab - INFO - Created issues file: d:\InnoLab\SonarQ\list_real_bugs.json with 2 bugs
2025-08-25 14:50:10,893 - innolab - INFO - Running command: python batch_fix.py source_bug --fix --auto --issues-file list_real_bugs.json
2025-08-25 14:51:42,384 - innolab - INFO - Enhanced Secure Batch Fix Script
2025-08-25 14:51:42,384 - innolab - INFO - Advanced AI-powered code fixing with validation & safety checks
2025-08-25 14:51:42,385 - innolab - INFO - ======================================================================
2025-08-25 14:51:42,385 - innolab - INFO - FIXING Mode Enabled
2025-08-25 14:51:42,385 - innolab - INFO - Fixing files in-place (overwriting originals)
2025-08-25 14:51:42,386 - innolab - INFO - Loading issues from: list_real_bugs.json
2025-08-25 14:51:42,386 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_145012.log
2025-08-25 14:51:42,386 - innolab - INFO - Loaded 0 issues from list_real_bugs.json
2025-08-25 14:51:42,386 - innolab - INFO - Issues found in 0 files
2025-08-25 14:51:42,387 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_145012.log
2025-08-25 14:51:42,387 - innolab - INFO - Loaded 39 custom ignore patterns from .fixignore
2025-08-25 14:51:42,387 - innolab - INFO - Scan Results:
2025-08-25 14:51:42,388 - innolab - INFO - Directory: source_bug
2025-08-25 14:51:42,388 - innolab - INFO - Found 11 code files
2025-08-25 14:51:42,388 - innolab - INFO - Files to process:
2025-08-25 14:51:42,388 - innolab - INFO - 1. appy.py
2025-08-25 14:51:42,388 - innolab - INFO - 2. Flask App\app.py
2025-08-25 14:51:42,389 - innolab - INFO - 3. Flask App\Static\roadmap.txt
2025-08-25 14:51:42,389 - innolab - INFO - 4. Flask App\Static\style.css
2025-08-25 14:51:42,389 - innolab - INFO - 5. Flask App\Templates\administration.html
2025-08-25 14:51:42,389 - innolab - INFO - 6. Flask App\Templates\cust_error.html
2025-08-25 14:51:42,389 - innolab - INFO - 7. Flask App\Templates\homepage.html
2025-08-25 14:51:42,390 - innolab - INFO - 8. Flask App\Templates\index.html
2025-08-25 14:51:42,390 - innolab - INFO - 9. Flask App\Templates\readme.html
2025-08-25 14:51:42,390 - innolab - INFO - 10. Flask App\Templates\sl.html
2025-08-25 14:51:42,390 - innolab - INFO - ... and 1 more files
2025-08-25 14:51:42,391 - innolab - INFO - Auto mode: proceeding without confirmation
2025-08-25 14:51:42,391 - innolab - INFO - ======================================================================
2025-08-25 14:51:42,391 - innolab - INFO - Starting secure fixing...
2025-08-25 14:51:42,391 - innolab - INFO - Template usage logging enabled: ./logs\template_usage_20250825_145012.log
2025-08-25 14:51:42,391 - innolab - INFO - [1/11] Fixing: appy.py
2025-08-25 14:51:42,392 - innolab - INFO - Success (11.2s)
2025-08-25 14:51:42,392 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:51:42,392 - innolab - INFO - [2/11] Fixing: Flask App\app.py
2025-08-25 14:51:42,392 - innolab - INFO - Success (5.8s)
2025-08-25 14:51:42,392 - innolab - INFO - Changes: Size change: 293 bytes; Similarity: 80.9%
2025-08-25 14:51:42,393 - innolab - INFO - [3/11] Fixing: Flask App\Static\roadmap.txt
2025-08-25 14:51:42,393 - innolab - INFO - Success (6.9s)
2025-08-25 14:51:42,393 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:51:42,393 - innolab - INFO - [4/11] Fixing: Flask App\Static\style.css
2025-08-25 14:51:42,393 - innolab - INFO - Retry 1: Syntax errors found, retrying...
2025-08-25 14:51:42,394 - innolab - INFO - Retry 2: Syntax errors found, retrying...
2025-08-25 14:51:42,394 - innolab - INFO - Failed: Syntax validation failed: Line 21: Missing semicolon
2025-08-25 14:51:42,394 - innolab - INFO - [5/11] Fixing: Flask App\Templates\administration.html
2025-08-25 14:51:42,394 - innolab - INFO - Success (6.8s)
2025-08-25 14:51:42,394 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:51:42,395 - innolab - INFO - [6/11] Fixing: Flask App\Templates\cust_error.html
2025-08-25 14:51:42,395 - innolab - INFO - Success (5.4s)
2025-08-25 14:51:42,395 - innolab - INFO - Changes: Size change: 25 bytes; Similarity: 93.6%
2025-08-25 14:51:42,395 - innolab - INFO - [7/11] Fixing: Flask App\Templates\homepage.html
2025-08-25 14:51:42,395 - innolab - INFO - Success (9.8s)
2025-08-25 14:51:42,396 - innolab - INFO - Changes: Size change: 120 bytes; Similarity: 96.3%
2025-08-25 14:51:42,396 - innolab - INFO - [8/11] Fixing: Flask App\Templates\index.html
2025-08-25 14:51:42,396 - innolab - INFO - Success (6.3s)
2025-08-25 14:51:42,396 - innolab - INFO - Changes: Size change: 70 bytes; Similarity: 97.3%
2025-08-25 14:51:42,397 - innolab - INFO - [9/11] Fixing: Flask App\Templates\readme.html
2025-08-25 14:51:42,397 - innolab - INFO - Success (5.3s)
2025-08-25 14:51:42,397 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:51:42,397 - innolab - INFO - [10/11] Fixing: Flask App\Templates\sl.html
2025-08-25 14:51:42,398 - innolab - INFO - Success (6.9s)
2025-08-25 14:51:42,398 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:51:42,398 - innolab - INFO - [11/11] Fixing: Flask App\Templates\temp.html
2025-08-25 14:51:42,398 - innolab - INFO - Success (2.9s)
2025-08-25 14:51:42,398 - innolab - INFO - Changes: Size change: 0 bytes; Similarity: 100.0%
2025-08-25 14:51:42,399 - innolab - INFO - ======================================================================
2025-08-25 14:51:42,399 - innolab - INFO - BATCH_FIX_RESULT: SUCCESS
2025-08-25 14:51:42,399 - innolab - INFO - FIXED_FILES: 10
2025-08-25 14:51:42,399 - innolab - INFO - FAILED_FILES: 1
2025-08-25 14:51:42,399 - innolab - INFO - TOTAL_INPUT_TOKENS: 10478
2025-08-25 14:51:42,400 - innolab - INFO - TOTAL_OUTPUT_TOKENS: 9438
2025-08-25 14:51:42,400 - innolab - INFO - TOTAL_TOKENS: 19916
2025-08-25 14:51:42,400 - innolab - INFO - AVERAGE_SIMILARITY: 0.968
2025-08-25 14:51:42,400 - innolab - INFO - THRESHOLD_MET_COUNT: 9
2025-08-25 14:51:42,400 - innolab - INFO - SIMILARITY_THRESHOLD: 0.85
2025-08-25 14:51:42,400 - innolab - INFO - DETAILED_RESULTS:
2025-08-25 14:51:42,401 - innolab - INFO - FILE: appy.py | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1570 | OUTPUT_TOKENS: 1643 | TOTAL_TOKENS: 3213 | THRESHOLD_MET: True
2025-08-25 14:51:42,401 - innolab - INFO - FILE: Flask App\app.py | STATUS: SUCCESS | SIMILARITY: 0.809 | INPUT_TOKENS: 839 | OUTPUT_TOKENS: 832 | TOTAL_TOKENS: 1671 | THRESHOLD_MET: False
2025-08-25 14:51:42,401 - innolab - INFO - FILE: Flask App\Static\roadmap.txt | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1219 | OUTPUT_TOKENS: 978 | TOTAL_TOKENS: 2197 | THRESHOLD_MET: True
2025-08-25 14:51:42,401 - innolab - INFO - FILE: Flask App\Static\style.css | STATUS: FAILED | SIMILARITY: 0.000 | INPUT_TOKENS: 0 | OUTPUT_TOKENS: 0 | TOTAL_TOKENS: 0 | THRESHOLD_MET: False
2025-08-25 14:51:42,401 - innolab - INFO - FILE: Flask App\Templates\administration.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 932 | OUTPUT_TOKENS: 860 | TOTAL_TOKENS: 1792 | THRESHOLD_MET: True
2025-08-25 14:51:42,402 - innolab - INFO - FILE: Flask App\Templates\cust_error.html | STATUS: SUCCESS | SIMILARITY: 0.936 | INPUT_TOKENS: 773 | OUTPUT_TOKENS: 723 | TOTAL_TOKENS: 1496 | THRESHOLD_MET: True
2025-08-25 14:51:42,402 - innolab - INFO - FILE: Flask App\Templates\homepage.html | STATUS: SUCCESS | SIMILARITY: 0.963 | INPUT_TOKENS: 1356 | OUTPUT_TOKENS: 1460 | TOTAL_TOKENS: 2816 | THRESHOLD_MET: True
2025-08-25 14:51:42,402 - innolab - INFO - FILE: Flask App\Templates\index.html | STATUS: SUCCESS | SIMILARITY: 0.973 | INPUT_TOKENS: 1057 | OUTPUT_TOKENS: 914 | TOTAL_TOKENS: 1971 | THRESHOLD_MET: True
2025-08-25 14:51:42,402 - innolab - INFO - FILE: Flask App\Templates\readme.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 953 | OUTPUT_TOKENS: 819 | TOTAL_TOKENS: 1772 | THRESHOLD_MET: True
2025-08-25 14:51:42,402 - innolab - INFO - FILE: Flask App\Templates\sl.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 1043 | OUTPUT_TOKENS: 896 | TOTAL_TOKENS: 1939 | THRESHOLD_MET: True
2025-08-25 14:51:42,403 - innolab - INFO - FILE: Flask App\Templates\temp.html | STATUS: SUCCESS | SIMILARITY: 1.000 | INPUT_TOKENS: 736 | OUTPUT_TOKENS: 313 | TOTAL_TOKENS: 1049 | THRESHOLD_MET: True
2025-08-25 14:51:42,403 - innolab - INFO - AVERAGE_PROCESSING_TIME: 8.2
2025-08-25 14:51:42,403 - innolab - INFO - END_BATCH_RESULT
2025-08-25 14:51:42,403 - innolab - INFO - {"success": true, "fixed_count": 10, "failed_count": 1, "total_input_tokens": 10478, "total_output_tokens": 9438, "total_tokens": 19916, "average_similarity": 0.9680939963383167, "threshold_met_count": 9, "similarity_threshold": 0.85, "average_processing_time": 8.20118290909091}
2025-08-25 14:51:44,583 - innolab - INFO - Batch fix completed successfully. Fixed 10 files
2025-08-25 14:51:44,584 - innolab - INFO - Token usage - Input: 10478, Output: 9438, Total: 19916
2025-08-25 14:51:44,584 - innolab - INFO - Average similarity: 0.968, Threshold met: 9
2025-08-25 14:51:44,584 - innolab - INFO - Cleaned up temporary issues file: d:\InnoLab\SonarQ\list_real_bugs.json
2025-08-25 14:51:44,584 - innolab - INFO - Loading Bearer scan results for project: my-service
2025-08-25 14:51:44,585 - innolab - INFO - Reading Bearer scan results from: d:\InnoLab\SonarQ\bearer_results\bearer_results_my-service.json
2025-08-25 14:51:44,585 - innolab - INFO - Bearer scan results loaded successfully
2025-08-25 14:51:44,585 - innolab - INFO - Converted 3 Bearer findings to compatible format
2025-08-25 14:51:44,585 - innolab - INFO - Found 3 Bearer security issues
2025-08-25 14:51:44,585 - innolab - INFO - Rescan found 3 open bugs (0 BUG, 0 CODE_SMELL)
2025-08-25 14:51:44,586 - innolab - INFO - Bugs reduced: 0 (from 3 to 3)
2025-08-25 14:51:44,586 - innolab - INFO - Iteration 5 completed: 3 bugs remain after rescan
2025-08-25 14:51:44,586 - innolab - INFO - === EXECUTION RESULT ===
2025-08-25 14:51:44,586 - innolab - INFO - Mode: LOCAL
2025-08-25 14:51:44,586 - innolab - INFO - Project: my-service
2025-08-25 14:51:44,586 - innolab - INFO - Total bugs fixed: 50
2025-08-25 14:51:44,586 - innolab - INFO - Total iterations: 5
2025-08-25 14:51:44,586 - innolab - INFO - Start time: 2025-08-25T14:44:00.827776
2025-08-25 14:51:44,586 - innolab - INFO - End time: 2025-08-25T14:51:44.586318
2025-08-25 14:51:44,586 - innolab - INFO - Iteration 1: 3 bugs found, 10 fixed
2025-08-25 14:51:44,587 - innolab - INFO - Iteration 2: 3 bugs found, 10 fixed
2025-08-25 14:51:44,587 - innolab - INFO - Iteration 3: 3 bugs found, 10 fixed
2025-08-25 14:51:44,587 - innolab - INFO - Iteration 4: 3 bugs found, 10 fixed
2025-08-25 14:51:44,587 - innolab - INFO - Iteration 5: 3 bugs found, 10 fixed
