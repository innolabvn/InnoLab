{"critical":[{"cwe_ids":["502"],"id":"python_lang_avoid_pickle","title":"Usage of unsafe Pickle libraries","description":"## Description\n\nUsing pickle, _pickle and cPickle can make your application vulnerable to unsafe code execution. This is because the deserialization logic of these libraries allows for arbitrary code execution. It is best practices to avoid these libraries and to use a safer serialization formats like JSON.\n\n## Remediations\n\n- **Do not** use pickle or its derivatives for deserialization wherever possible. These libraries are open to security vulnerabilities.\n- **Do** use recommended safer formats like JSON, Protocol Buffers (protobuf) and MessagePack.\n  ```python\n    import msgpack #MessagePack\n\n    data = {'key': 'value'}\n    packed_data = msgpack.packb(data)\n  ```\n\n## References\n\n- [OWASP Deserialization cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html)\n","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_avoid_pickle","line_number":48,"full_filename":"/scan/appy.py","filename":"appy.py","source":{"start":48,"end":48,"column":{"start":11,"end":29}},"sink":{"start":48,"end":48,"column":{"start":11,"end":29},"content":""},"parent_line_number":48,"fingerprint":"dacfec7a132bf64e199a6d2ad0d36a87_0","old_fingerprint":"cae4da2c73beb8e04c11776e28b5940a_0","code_extract":"    obj = pickle.loads(data)  # vulnerable"}],"high":[{"cwe_ids":["295"],"id":"python_lang_ssl_verification","title":"Missing SSL certificate verification","description":"## Description\n\nMissing or optional SSL certificate verification can compromise the security of sensitive data. This vulnerability arises when an application fails to check for valid SSL certificates during data transmission, potentially allowing attackers to intercept or manipulate data and leading to Man-in-the-Middle attacks. To protect against these kinds of attacks and to maintain secure communication, SSL certificates should always be properly validated in production environments.\n\n## Remediations\n\n- **Do not** disable SSL certificate verification in your HTTP client. Disabling it removes a critical layer of security and makes your application vulnerable to Man-in-the-Middle attacks.\n```python\nurllib3.HTTPSConnectionPool(..., cert_reqs=\"CERT_NONE\", ...) # unsafe\n# or\nrequests.get(..., verify=False, ...) # unsafe\n```\n- **Do** ensure SSL certificate verification is enabled when configuring connections, as well as hostname checking. For example, use `ssl.CERT_REQUIRED` to ensure SSL certificates are verified. \n  ```python\n  urllib3.HTTPSConnectionPool(\"my-host.com\", cert_reqs=ssl.CERT_REQUIRED, assert_hostname=True ...)\n  ```\n- **Do not** create custom SSL contexts that disable certificate verification\n```python\nctx = urllib3.create_urllib3_context(cert_reqs=ssl.CERT_NONE) # unsafe\n```\n\n## References\n- [Python 3 ssl module security considerations](https://docs.python.org/3/library/ssl.html#ssl-security)","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_ssl_verification","line_number":64,"full_filename":"/scan/appy.py","filename":"appy.py","source":{"start":64,"end":64,"column":{"start":9,"end":40}},"sink":{"start":64,"end":64,"column":{"start":9,"end":40},"content":""},"parent_line_number":64,"fingerprint":"d44c2edc9454db162c25339b54563d42_0","old_fingerprint":"8e84ca187b959cc85e1ebeb3e5702c1d_0","code_extract":"    r = requests.get(url, verify=False)"}],"medium":[{"cwe_ids":["328"],"id":"python_lang_weak_hash_md5","title":"Usage of weak hashing library (MDx)","description":"## Description\n\nUsing a weak hashing library, such as MD5, increases the risk of data breaches. MD5 itself is vulnerable to collision attacks, where two different inputs can produce the same hash value, compromising data integrity and security.\n\n## Remediations\n\n- **Do not** use MD5 for hashing. This algorithm is considered weak and vulnerable to attacks.\n  ```python\n  hashlib.md5('password').digest() # unsafe\n  ```\n- **Do** opt for stronger hashing algorithms like SHA-256 to enhance security.\n  ```python\n  hashlib.sha256('password').digest()\n  ```","documentation_url":"https://docs.bearer.com/reference/rules/python_lang_weak_hash_md5","line_number":55,"full_filename":"/scan/appy.py","filename":"appy.py","source":{"start":55,"end":55,"column":{"start":9,"end":39}},"sink":{"start":55,"end":55,"column":{"start":9,"end":39},"content":""},"parent_line_number":55,"fingerprint":"403b9d8f405ebbdf90685e618477f370_0","old_fingerprint":"f9f0a7a676cc6512a2d2ef517bafd6b4_0","code_extract":"    h = hashlib.md5(password.encode()).hexdigest()"}]}
